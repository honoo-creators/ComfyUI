import{d as $,k as b,g as u,f as T,G as C,l as c,p as d,m as j,h as r,w as l,q as A,H as B,v as G,W as D,z as O,ac as V,i as x,r as F,o as P,aa as S,s as E,a as U,ai as J,ah as M,J as z,M as I,N as W,ag as w,ad as L,t as q,e as R,c as N,F as H,B as K,aj as Q}from"./WHSOQWA4.js";import{_ as X}from"./DDdCgteD.js";import{_ as Y}from"./z4BbKwUn.js";import{L as Z}from"./Dy8Ia0_c.js";import"./DfZwukZZ.js";const ee={class:"lookStyle-image"},te={class:"lookStyle-name"},v=$({__name:"LookStyle",props:{data:{type:Object,default:()=>({})},current:{type:Boolean,default:!1}},setup(f){const m=f,y=b(()=>m.data.name),i=b(()=>m.data.thumbnail_path);return(h,p)=>{const k=D,g=Y,e=O;return u(),T("div",{class:G(["lookStyle",{_current:f.current}])},[C("div",ee,[c(i)?(u(),d(k,j({key:0},{src:c(i)},{cover:""}),null,16)):(u(),d(g,{key:1,w:"100%",h:"100%"}))]),C("div",te,[r(Z,null,{default:l(()=>[r(e,{title1:"",extrabold:"",center:"",unselectable:"",color:"light"},{default:l(()=>[A(B(c(y)),1)]),_:1})]),_:1})])],2)}}}),le=$({__name:"lookstyle",setup(f){const m={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},y=Q(),i=V(),{lookStyle:h}=x(i),p=F([]),k=e=>{const s=p.value.find(t=>t.id===e);s&&(i.setLookStyle(s),R().push(N().GENERATE_UPLOAD))},g=async()=>{const e=await y.select(["json"]),s=e.blob,t=async n=>new Promise((_,o)=>{const a=new FileReader;a.onload=()=>_(a.result),a.onerror=()=>o(new Error("ファイルの読み込みに失敗しました")),a.readAsText(n)});try{const _=await(await fetch(s)).blob(),o=await t(_),a={...m,name:e.name.replace(".json","")};i.setLookStyle(a),i.setCustomWorkflow(JSON.parse(o)),R().push(N().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return P(async()=>{var e,s;if(!S().active)return E("利用プランが選択されていません。");try{const t=await U().template.lookStyle(((e=S().active)==null?void 0:e.id)??0);(s=t.list)!=null&&s.length&&(p.value=t.list.map(n=>({...n,thumbnail_path:"/honoo/assets/lookstyle/honoo_bgart_v04.jpg"})))}catch(t){if(t instanceof J)M().error(t);else return E("背景美術スタイルの取得に失敗しました。")}}),(e,s)=>{const t=H,n=K,_=z;return u(),d(_,{class:"pageGenerateLookstyle",gap:"28"},{default:l(()=>[r(t,null,{default:l(()=>[r(X,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),r(t,{wide:""},{default:l(()=>[r(n,{justify:"center",gap:"16"},{default:l(()=>[(u(!0),T(W,null,I(c(p),o=>(u(),d(L,{key:o.id,class:"pageGenerateLookstyle-item",onClick:a=>k(o.id)},{default:l(()=>{var a;return[r(v,{data:o,current:o.id===((a=c(h))==null?void 0:a.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in e?e.useRuntimeConfig:c(w))().public.DEV_ENABLED&&("useRuntimeConfig"in e?e.useRuntimeConfig:c(w))().public.ENVIRONMENT==="local"?(u(),d(L,{key:0,class:"pageGenerateLookstyle-item",onClick:g},{default:l(()=>{var o;return[r(v,{data:m,current:m.id===((o=c(h))==null?void 0:o.id)},null,8,["current"])]}),_:1})):q("",!0)]),_:1})]),_:1})]),_:1})}}});export{le as default};
