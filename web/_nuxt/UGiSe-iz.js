import{d as L,r as v,k as b,a0 as K,o as W,U as j,Q as G,g as p,f as $,G as N,R as Q,am as X,m as A,an as Y,p as k,w as i,H as E,t as V,z as C,v as O,h as d,N as J,M as z,_ as R,l as U,B as q,q as P,D as Z,K as ee,ao as te,ap as ae,aq as le,J as ne,ar as se,ad as ue}from"./5NVV-yna.js";import{u as oe,_ as re}from"./CHU3lYNQ.js";const ie=["data-value"],de=["placeholder"],ce={class:"textarea-label-inner"},fe={key:0,class:"textarea-label-required"},pe="update:modelValue",me="valid",ve="invalid",ge="focus",he="blur",ye=L({__name:"Textarea",props:{name:{type:String,default:"textarea",required:!0},type:{type:String,default:"text"},label:{type:String,default:""},placeholder:{type:String,default:""},description:{type:String,default:""},modelValue:{type:String,default:"",required:!0},autocomplete:{type:Boolean,default:!1},autoheight:{type:Boolean,default:!0},pattern:{type:String},maxlength:{type:[Number,String]},rows:{type:[Number,String],default:1},maxRows:{type:[Number,String],default:null},required:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},focus:{type:Boolean,default:!1},nowrap:{type:Boolean,default:!1},noBorder:{type:Boolean,default:!1},validation:{type:String,default:"blur",validator:t=>["always","blur"].includes(t)}},emits:["update:modelValue","enter-key-down","valid","invalid","focus","blur"],setup(t,{emit:l}){const{noOnlySpace:h}=oe(),e=t,u=l,y=v("idle"),s=v(!1),_=v(!1),x=`textarea-${e.name}`,S=v(""),o=v(null),c=v(null),f=b(()=>({[`_${y.value}`]:!0,_focus:s.value,_input:r.value.length,_noLabel:!e.label,_readonly:e.readonly,_maxHeight:!!e.maxRows})),r=b({get:()=>e.modelValue,set:n=>{u(pe,n)}}),w=b(()=>s.value||!e.label?e.placeholder:""),M=b(()=>e.maxRows&&c.value!==null?`${c.value*Number.parseInt(String(e.maxRows))}px`:"none");K(()=>e.modelValue,()=>{e.validation==="always"&&I()});const T=()=>{o.value&&e.autoheight&&(o.value.style.height="auto",o.value.style.height=`${o.value.scrollHeight}px`)},F=n=>{n.key==="Enter"&&e.nowrap&&n.preventDefault()},H=()=>{s.value=!0,u(ge)},D=()=>{e.validation==="blur"&&I(),s.value=!1,u(he)},I=()=>{let n="";r.value===""&&e.required&&(n=`${e.placeholder?`${e.placeholder}を`:""}入力してください。`),!n&&e.maxlength&&r.value.length>Number.parseInt(String(e.maxlength))&&(n=`${e.maxlength}文字以内で入力してください。現在${r.value.length}文字です。`),!n&&r.value!==""&&r.value.match(h)&&(n="空白のみの入力はできません。"),n?(y.value="invalid",u(ve,n),S.value=n):(y.value="valid",u(me),S.value="")};return W(async()=>{if(await j(),r.value&&I(),o.value){const n=window.getComputedStyle(o.value);c.value=Number.parseFloat(n.lineHeight),e.autoheight&&(o.value.style.height="auto",o.value.style.height=`${o.value.scrollHeight}px`)}}),(n,a)=>{const g=G("focus");return p(),$("div",{class:O(["textarea",f.value])},[N("div",{class:"textarea-inner","data-value":t.autoheight?r.value:"",style:Y({maxHeight:M.value})},[Q(N("textarea",A({id:x,ref_key:"fieldEl",ref:o,"onUpdate:modelValue":a[0]||(a[0]=m=>r.value=m),class:"textarea-inner-field",placeholder:w.value},{name:t.name,readonly:t.readonly,rows:t.rows},{onInput:T,onKeydown:F,onFocus:H,onBlur:D,onMouseover:a[1]||(a[1]=m=>_.value=!0),onMouseleave:a[2]||(a[2]=m=>_.value=!1)}),null,16,de),[[X,r.value],[g,t.focus]])],12,ie),t.label?(p(),k(C,{key:0,tag:"label",for:x,class:"textarea-label"},{default:i(()=>[N("span",ce,E(t.label),1),t.required?(p(),$("span",fe,"*")):V("",!0)]),_:1})):V("",!0)],2)}}}),_e={class:"inputTag-label-inner"},be={key:0,class:"inputTag-label-required"},xe=L({__name:"InputTag",props:{name:{type:String,default:"tag",required:!0},modelValue:{type:Array,default:[]},label:{type:String,default:""},placeholder:{type:String,default:"フリーテキストで追加"},max:{type:[Number,String],default:0},description:{type:String,default:""},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},gap:{type:[Number,String],default:8},focus:{type:Boolean,default:!1}},emits:{"update:modelValue":t=>!0,"enter-key-down":()=>!0,valid:()=>!0,invalid:t=>!0,focus:()=>!0,blur:()=>!0},setup(t,{emit:l}){const{darkmode:h}=te(),e=t,u=l,y=v("idle"),s=v(""),_=v(!1),x=v(!1),S=`inputTag-${e.name}`,o=v(""),c=b(()=>({[`_${y.value}`]:!0,_focus:_.value,_has:f.value.length>0})),f=b({get:()=>e.modelValue,set:a=>{u("update:modelValue",a)}}),r=b(()=>{let a=!0;return e.max&&(a=f.value.length<Number.parseInt(String(e.max))),a}),w=b(()=>{var B;const a=e.placeholder.length,g=(B=s.value)==null?void 0:B.length;return{minWidth:`${Math.max(a,g)}em`}}),M=b(()=>{let a=e.placeholder;return e.label&&!_.value&&(a=""),a}),T=()=>{s.value&&!f.value.includes(s.value)&&(f.value.push(s.value),s.value=""),n()},F=a=>{f.value.splice(f.value.indexOf(a),1),n()},H=()=>{s.value.includes(`
`)&&(s.value=s.value.replace(/\n/g,""),T())},D=()=>{_.value=!0,u("focus")},I=()=>{_.value=!1,u("blur"),s.value&&T(),n()},n=()=>{let a="";!f.value.length&&e.required&&(a="入力してください。"),a?(y.value="invalid",u("invalid",a),o.value=a):(y.value="valid",u("valid"),o.value="")};return(a,g)=>(p(),$("div",{class:O(["inputTag",c.value]),onMouseover:g[1]||(g[1]=m=>x.value=!0),onMouseleave:g[2]||(g[2]=m=>x.value=!1)},[t.label?(p(),k(C,{key:0,tag:"label",for:S,class:"inputTag-label"},{default:i(()=>[N("span",_e,E(t.label),1),t.required?(p(),$("span",be,"*")):V("",!0)]),_:1})):V("",!0),d(q,A({class:"inputTag-items"},{gap:t.gap},{justify:"start",align:"stretch"}),{default:i(()=>[(p(!0),$(J,null,z(f.value,(m,B)=>(p(),k(R,{key:`inputTag-items-item-${B}`,class:"inputTag-items-item",pt:"3.2",pb:"4.8",pl:"8",pr:"4",r:"2",color:U(h)?"light":"dark",relative:"","inline-block":""},{default:i(()=>[d(q,{gap:"4",align:"center"},{default:i(()=>[d(C,{body:"",bold:"",lineclamp:"1",color:U(h)?"dark":"light"},{default:i(()=>[P(E(m),1)]),_:2},1032,["color"]),d(Z,{minimal:"",xsmall:"",w:"20",h:"20",onClick:Ve=>F(m)},{default:i(()=>[d(R,{pt:"2",mr:"-4"},{default:i(()=>[d(ee,{name:"cross",size:"10",color:"light"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["color"]))),128)),d(q,{align:"center",style:{width:"auto"}},{default:i(()=>[r.value?(p(),k(ye,A({key:0,id:S,modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=m=>s.value=m),style:w.value,placeholder:M.value,type:"text",rows:"1",autoheight:!1},{name:t.name,focus:t.focus},{onInput:H,onFocus:D,onBlur:I}),null,16,["modelValue","style","placeholder"])):V("",!0)]),_:1})]),_:1},16)],34))}}),Se={class:"promptInput"},Be=L({__name:"PromptInput",props:ae({name:{type:String,required:!0},placeholder:{type:String,required:!0},list:{type:Array,default:()=>[]}},{selects:{},selectsModifiers:{}}),emits:["update:selects"],setup(t){const l=le(t,"selects"),h=e=>{var u;(u=l.value)==null||u.push(e)};return(e,u)=>{const y=xe,s=C,_=re,x=ne,S=q,o=se;return p(),$("div",Se,[d(x,{gap:"0"},{default:i(()=>[d(s,{body:"",bold:""},{default:i(()=>[d(y,A({modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=c=>l.value=c),name:"promptA"},{placeholder:t.placeholder},{max:"10",gap:"4",focus:""}),null,16,["modelValue"])]),_:1}),d(_)]),_:1}),d(o,{class:"promptInput-tags"},{default:i(()=>[d(S,{gap:"4"},{default:i(()=>[(p(!0),$(J,null,z(t.list,(c,f)=>{var r,w;return p(),k(ue,{key:`promptInput-tags-item-${f}`,class:O(`promptInput-tags-item${(r=l.value)!=null&&r.includes(c)?" _selected":""}`),disabled:(w=l.value)==null?void 0:w.includes(c),onClick:M=>h(c)},{default:i(()=>[d(s,{caption2:"",bold:""},{default:i(()=>[P(E(c),1)]),_:2},1024)]),_:2},1032,["class","disabled","onClick"])}),128))]),_:1})]),_:1})])}}}),Ne=()=>({equal:$e,shuffle:we,unique:Ie,numberArray:ke}),$e=(t,l)=>JSON.stringify(t)===JSON.stringify(l),we=t=>{let l=[];for(;t.length>0;){let h=t.length,e=Math.floor(Math.random()*h);l.push(t[e]),t.splice(e,1)}return l},Ie=t=>Array.from(new Set(t.map(l=>JSON.stringify(l)))).map(l=>JSON.parse(l)),ke=(t,l)=>Array.from({length:l},(h,e)=>t+e);export{Be as _,Ne as u};
