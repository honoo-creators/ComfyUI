import{d as L,am as $,z as j,o as x,a9 as f,s as y,a as A,aj as G,ai as R,f as p,k as h,w as c,h as r,g as T,H as v,i as _,G as B,aB as k,$ as b,e as w,W as N,y as F,V as O}from"./CvNwVGvF.js";import{u as P}from"./-l16dqB2.js";import{_ as U}from"./DCrCMofR.js";import{_ as C}from"./BsJvnsJF.js";import{u as D}from"./DuSZBVOy.js";import"./DfFKjqG5.js";import"./DFiSov9q.js";import"./KL11dRCu.js";const Q=L({__name:"lookstyle",setup(J){const u={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},g=D(),i=P(),{lookStyle:d}=$(i),m=j([]),E=s=>{const a=m.value.find(e=>e.id===s);a&&(i.setLookStyle(a),b().push(w().GENERATE_UPLOAD))},S=async()=>{const s=await g.select(["json"]),a=s.blob,e=async n=>new Promise((l,t)=>{const o=new FileReader;o.onload=()=>l(o.result),o.onerror=()=>t(new Error("ファイルの読み込みに失敗しました")),o.readAsText(n)});try{const l=await(await fetch(a)).blob(),t=await e(l),o={...u,name:s.name.replace(".json","")};i.setLookStyle(o),i.setCustomWorkflow(JSON.parse(t)),b().push(w().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return x(async()=>{var s,a;if(!f().active)return y("利用プランが選択されていません。");try{const e=await A().template.lookStyle(((s=f().active)==null?void 0:s.id)??0);(a=e.list)!=null&&a.length&&(m.value=e.list.map(n=>({...n,thumbnail_path:"https://cdn.pixabay.com/photo/2024/05/26/15/27/anime-8788959_1280.jpg"})))}catch(e){if(e instanceof G)R().error(e);else return y("背景美術スタイルの取得に失敗しました。")}}),(s,a)=>{const e=N,n=F,l=O;return p(),h(l,{class:"pageGenerateLookstyle",gap:"28"},{default:c(()=>[r(e,null,{default:c(()=>[r(U,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),r(e,{wide:""},{default:c(()=>[r(n,{justify:"center",gap:"16"},{default:c(()=>[(p(!0),T(B,null,v(_(m),t=>(p(),h(k,{key:t.id,class:"pageGenerateLookstyle-item",onClick:o=>E(t.id)},{default:c(()=>{var o;return[r(C,{data:t,current:t.id===((o=_(d))==null?void 0:o.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),r(k,{class:"pageGenerateLookstyle-item",onClick:S},{default:c(()=>{var t;return[r(C,{data:u,current:u.id===((t=_(d))==null?void 0:t.id)},null,8,["current"])]}),_:1})]),_:1})]),_:1})]),_:1})}}});export{Q as default};
