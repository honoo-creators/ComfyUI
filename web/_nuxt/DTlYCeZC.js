import{d as B,aa as R,r as O,c as V,g as r,l as i,w as t,i as o,j as e,x as u,D as c,E as $,ai as b,a4 as N,$ as P,f as F,aj as J,C as L,X as M,W as Q,_ as q,ar as z,A as W,a1 as X,a as Y}from"./QWLheGxm.js";import{_ as H}from"./BQTQAAhM.js";import{_ as K}from"./jVg1g8KE.js";import{_ as Z,a as f}from"./D2l31ITd.js";import{u as ee}from"./CBNVf8Es.js";import{u as ae}from"./D2vpUSql.js";import"./ArkP60Hn.js";import"./DLFdnAhv.js";import"./DmolMG9N.js";const fe=B({__name:"confirm",setup(te){const{lookStyle:k,base64:p,imageFile:j,promptA:d,promptB:_,promptC:y,promptD:g,workflow:I}=ee(),{face:U,name:D,ticket:C}=R(),w=Y(),E=ae(),h=O(!1),x=V(()=>N().public.COMFYUI_GENERATE_ENABLED),A=()=>{b().alert({title:"ComfyUI Queue Disabled",message:"この環境では画像生成が許可されていません。",icon:"prohibited"})},T=async()=>{h.value=!0;let m={};try{if(N().public.ENVIRONMENT==="local"){m=I;const{name:a}=await E.upload.image(j);"nodes"in m&&m.nodes.forEach(n=>{if(typeof n=="object"&&n!==null&&"type"in n&&"widgets_values"in n){const s=n;s.type==="LoadImage"&&(s.widgets_values=s.widgets_values.map(l=>typeof l=="string"?a:l))}})}else{const{original_image_id:a}=await w.upload.originalImage(p);m=await w.template.workflow({backgroundArtStyleId:2,prompt:[d,_,y,g].join(" "),retry_count:0,original_image_id:a})}await E.queuePrompt({json:JSON.stringify(m),batchCount:1}),P().push(F().OUTPUT)}catch(a){h.value=!1,a instanceof J?b().error(a):b().error({title:"Generate Error",message:"生成に失敗しました。",icon:"exclamation",button:"閉じる",code:L.UnknownError,name:"UnknownError"})}};return(m,a)=>{const n=M,s=Q,l=q,G=z,S=W,v=X;return r(),i(s,{class:"pageGenerateConfirm",gap:"28"},{default:t(()=>[o(n,null,{default:t(()=>[o(H,{icon:"document",title:"設定内容の確認",body:"設定内容をご確認ください"})]),_:1}),o(n,null,{default:t(()=>[o(s,{justify:"stretch",gap:"32"},{default:t(()=>[o(s,{justify:"stretch",gap:"8"},{default:t(()=>[e(k)?(r(),i(K,{key:0,class:"pageGenerateConfirm-lookstyle",data:e(k)},null,8,["data"])):u("",!0),e(p)?(r(),i(Z,{key:1,data:e(p)},null,8,["data"])):u("",!0),e(d)?(r(),i(f,{key:2,data:e(d),name:"何を描くか"},null,8,["data"])):u("",!0),e(_)?(r(),i(f,{key:3,data:e(_),name:"周りの環境"},null,8,["data"])):u("",!0),e(y)?(r(),i(f,{key:4,data:e(y),name:"色調・ムード"},null,8,["data"])):u("",!0),e(g)?(r(),i(f,{key:5,data:e(g),name:"ライティング"},null,8,["data"])):u("",!0)]),_:1}),o(l,{title3:"",center:""},{default:t(()=>a[0]||(a[0]=[c(" 上記の設定で背景美術を生成します。 ")])),_:1}),o(s,{justify:"center",gap:"8"},{default:t(()=>[o(G,{src:e(U),size:"72"},null,8,["src"]),o(l,{headline:"",extrabold:"",center:""},{default:t(()=>[c($(e(D)),1)]),_:1}),e(C)!==1/0?(r(),i(S,{key:0,justify:"center",align:"end",gap:"1",nowrap:""},{default:t(()=>[o(l,{body:"",bold:"","baseline-height":""},{default:t(()=>[c($(e(C)),1)]),_:1}),o(l,{caption2:"",bold:"","baseline-height":""},{default:t(()=>a[1]||(a[1]=[c(" チケット ")])),_:1})]),_:1})):u("",!0)]),_:1}),o(v,{disabled:!e(x),onClick:T,onDisabledClick:A},{default:t(()=>a[2]||(a[2]=[c(" 生成する ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}});export{fe as default};
