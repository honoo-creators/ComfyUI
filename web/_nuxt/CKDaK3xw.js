import{d as S,ak as x,x as A,o as G,a7 as f,s as h,a as $,ah as j,ag as R,f as p,i as k,w as c,z as r,g as T,G as v,X as _,F as B,aB as y,e as b,c as g,V as F,t as U,U as N}from"./DAo9FXbr.js";import{u as P}from"./By6Ylh0E.js";import{_ as D}from"./DNGJunTU.js";import{_ as w}from"./DuMCfYNM.js";import{u as O}from"./DuSZBVOy.js";import"./BmIP4cge.js";import"./CpxCey8m.js";import"./Cv5srlrQ.js";const K=S({__name:"lookstyle",setup(V){const u={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},C=O(),i=P(),{lookStyle:d}=x(i),m=A([]),E=s=>{const a=m.value.find(e=>e.id===s);a&&(i.setLookStyle(a),b().push(g().GENERATE_UPLOAD))},L=async()=>{const s=await C.select(["json"]),a=s.blob,e=async n=>new Promise((l,t)=>{const o=new FileReader;o.onload=()=>l(o.result),o.onerror=()=>t(new Error("ファイルの読み込みに失敗しました")),o.readAsText(n)});try{const l=await(await fetch(a)).blob(),t=await e(l),o={...u,name:s.name.replace(".json","")};i.setLookStyle(o),i.setCustomWorkflow(t),b().push(g().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return G(async()=>{var s,a;if(!f().active)return h("利用プランが選択されていません。");try{const e=await $().template.lookStyle(((s=f().active)==null?void 0:s.id)??0);(a=e.list)!=null&&a.length&&(m.value=e.list.map(n=>({...n,thumbnail_path:"https://cdn.pixabay.com/photo/2024/05/26/15/27/anime-8788959_1280.jpg"})))}catch(e){if(e instanceof j)R().error(e);else return h("背景美術スタイルの取得に失敗しました。")}}),(s,a)=>{const e=F,n=U,l=N;return p(),k(l,{class:"pageGenerateLookstyle",gap:"28"},{default:c(()=>[r(e,null,{default:c(()=>[r(D,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),r(e,{wide:""},{default:c(()=>[r(n,{justify:"center",gap:"16"},{default:c(()=>[(p(!0),T(B,null,v(_(m),t=>(p(),k(y,{key:t.id,class:"pageGenerateLookstyle-item",onClick:o=>E(t.id)},{default:c(()=>{var o;return[r(w,{data:t,current:t.id===((o=_(d))==null?void 0:o.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),r(y,{class:"pageGenerateLookstyle-item",onClick:L},{default:c(()=>{var t;return[r(w,{data:u,current:u.id===((t=_(d))==null?void 0:t.id)},null,8,["current"])]}),_:1})]),_:1})]),_:1})]),_:1})}}});export{K as default};
