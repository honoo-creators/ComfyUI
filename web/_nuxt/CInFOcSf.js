import{d as v,x as o,P as u,f as U,g as C,z as r,w as f,aa as I,A as N,ab as p,ac as T,a2 as $,U as h,a5 as k,a1 as x,ad as F}from"./Dgu-BcZp.js";const M={class:"pageDevComfyUITestUpscale"},n=3,D=v({__name:"test-upscale",setup(A){const s=k(),d=x(),m=o(0),t=o(0),_=o(""),c=o(!1);u(()=>s.output.value,async e=>{console.log("comfyUI.output:",e,"count:",t.value,"MAX_COUNT:",n,"isDownloaded:",c.value),t.value===n&&!c.value&&(await F().download(e[0],_.value),c.value=!0,p().close(),close())},{immediate:!0,deep:!0}),u(()=>s.progress.value,async e=>{const a=Math.round(e/n*100+t.value*(100/n));m.value=Math.min(a,100),e>=1&&t.value++},{immediate:!0,deep:!0});const g=async()=>{const e=await d.select(["image"]);if(e){p().open({icon:"",message:"Now Upscaling...",progress:!0});const a=e.file,l=new File([a],`${a.name.split(".")[0]}_upscale.${a.name.split(".")[1]}.png`,{type:a.type}),{name:i}=await s.upload.image(l),w=s.workflow.replaceLoadImage(T,i);s.queuePrompt({json:JSON.stringify(w)}),u(()=>m.value,async y=>{p().update({icon:"",message:`${y}%`,progress:!0})},{immediate:!0,deep:!0})}};return(e,a)=>{const l=$,i=h;return U(),C("div",M,[r(i,{justify:"center",align:"center",gap:"40"},{default:f(()=>[r(I,{icon:"shaps",title:"Test Upscale",body:"ComfyUI のアップスケールワークフローをテストします。"}),r(l,{w:"160",onClick:g},{default:f(()=>a[0]||(a[0]=[N(" Test ")])),_:1})]),_:1})])}}});export{D as default};
