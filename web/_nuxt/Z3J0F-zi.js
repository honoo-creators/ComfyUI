import{d as S,aE as N,am as A,x as $,o as G,aa as k,s as y,a as T,ag as j,af as v,f as m,i as f,w as r,z as l,g as F,G as B,Y as c,F as D,$ as h,aF as g,l as O,e as C,c as b,V as U,t as V,U as P,a1 as x}from"./CVjm8Pq9.js";import{_ as J}from"./kcRfV08M.js";import{_ as E}from"./B5V1-kuU.js";import"./B7cQzEF0.js";import"./C59-a2ec.js";import"./CmMSoR0i.js";const K=S({__name:"lookstyle",setup(M){const p={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},w=x(),u=N(),{lookStyle:_}=A(u),d=$([]),R=e=>{const a=d.value.find(t=>t.id===e);a&&(u.setLookStyle(a),C().push(b().GENERATE_UPLOAD))},L=async()=>{const e=await w.select(["json"]),a=e.blob,t=async n=>new Promise((i,o)=>{const s=new FileReader;s.onload=()=>i(s.result),s.onerror=()=>o(new Error("ファイルの読み込みに失敗しました")),s.readAsText(n)});try{const i=await(await fetch(a)).blob(),o=await t(i),s={...p,name:e.name.replace(".json","")};u.setLookStyle(s),u.setCustomWorkflow(JSON.parse(o)),C().push(b().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return G(async()=>{var e,a;if(!k().active)return y("利用プランが選択されていません。");try{const t=await T().template.lookStyle(((e=k().active)==null?void 0:e.id)??0);(a=t.list)!=null&&a.length&&(d.value=t.list.map(n=>({...n,thumbnail_path:"/honoo/assets/lookstyle/honoo_bgart_v04.jpg"})))}catch(t){if(t instanceof j)v().error(t);else return y("背景美術スタイルの取得に失敗しました。")}}),(e,a)=>{const t=U,n=V,i=P;return m(),f(i,{class:"pageGenerateLookstyle",gap:"28"},{default:r(()=>[l(t,null,{default:r(()=>[l(J,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),l(t,{wide:""},{default:r(()=>[l(n,{justify:"center",gap:"16"},{default:r(()=>[(m(!0),F(D,null,B(c(d),o=>(m(),f(g,{key:o.id,class:"pageGenerateLookstyle-item",onClick:s=>R(o.id)},{default:r(()=>{var s;return[l(E,{data:o,current:o.id===((s=c(_))==null?void 0:s.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in e?e.useRuntimeConfig:c(h))().public.DEV_ENABLED&&("useRuntimeConfig"in e?e.useRuntimeConfig:c(h))().public.ENVIRONMENT==="local"?(m(),f(g,{key:0,class:"pageGenerateLookstyle-item",onClick:L},{default:r(()=>{var o;return[l(E,{data:p,current:p.id===((o=c(_))==null?void 0:o.id)},null,8,["current"])]}),_:1})):O("",!0)]),_:1})]),_:1})]),_:1})}}});export{K as default};
