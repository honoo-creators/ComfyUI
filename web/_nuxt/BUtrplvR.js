import{aj as j,g as u,p as m,w as n,I as G,d as T,k as g,f as A,G as C,l as s,m as S,ak as x,t as B,h as i,q as D,H as O,v as P,W as V,z as F,ac as U,i as z,r as I,o as J,aa as E,s as R,a as M,al as W,ai as q,J as H,M as K,N as Q,ah as w,ad as L,e as N,c as $,F as X,B as Y,am as Z}from"./CWZ8UILv.js";import{_ as ee}from"./CokEUrg8.js";import{_ as te}from"./DfwfIJQD.js";import{_ as ae}from"./CdH-ClmR.js";import"./Bl7gFmoX.js";const oe={};function se(d,r){const p=te;return u(),m(p,{per:240/530*100,class:"lookStyleRatio"},{default:n(()=>[G(d.$slots,"default")]),_:3})}const ne=j(oe,[["render",se]]),re={class:"lookStyle-image"},le={class:"lookStyle-name"},v=T({__name:"LookStyle",props:{data:{type:Object,default:()=>({})},current:{type:Boolean,default:!1}},setup(d){const r=d,p=g(()=>r.data.name),_=g(()=>r.data.id),f=g(()=>r.data.thumbnail_path);return(k,b)=>{const h=V,e=F;return u(),A("div",{class:P(["lookStyle",{_current:d.current}])},[C("div",re,[s(f)?(u(),m(h,S({key:0},{src:s(f)},{cover:""}),null,16)):s(_)?(u(),m(ae,x(S({key:1},{id:s(_)})),null,16)):B("",!0)]),C("div",le,[i(ne,null,{default:n(()=>[i(e,{title1:"",extrabold:"",center:"",unselectable:"",color:"light"},{default:n(()=>[D(O(s(p)),1)]),_:1})]),_:1})])],2)}}}),de=T({__name:"lookstyle",setup(d){const r={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},p=Z(),_=U(),{lookStyle:f}=z(_),k=I([]),b=e=>{const l=k.value.find(t=>t.id===e);l&&(_.setLookStyle(l),N().push($().GENERATE_UPLOAD))},h=async()=>{const e=await p.select(["json"]),l=e.blob,t=async c=>new Promise((y,a)=>{const o=new FileReader;o.onload=()=>y(o.result),o.onerror=()=>a(new Error("ファイルの読み込みに失敗しました")),o.readAsText(c)});try{const y=await(await fetch(l)).blob(),a=await t(y),o={...r,name:e.name.replace(".json","")};_.setLookStyle(o),_.setCustomWorkflow(JSON.parse(a)),N().push($().GENERATE_UPLOAD)}catch(c){console.error("JSONの変換に失敗しました:",c)}};return J(async()=>{var e,l;if(!E().active)return R("利用プランが選択されていません。");try{const t=await M().template.lookStyle(((e=E().active)==null?void 0:e.id)??0);(l=t.list)!=null&&l.length&&(k.value=t.list.map(c=>({...c,thumbnail_path:""})))}catch(t){if(t instanceof W)q().error(t);else return R("背景美術スタイルの取得に失敗しました。")}}),(e,l)=>{const t=X,c=Y,y=H;return u(),m(y,{class:"pageGenerateLookstyle",gap:"28"},{default:n(()=>[i(t,null,{default:n(()=>[i(ee,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),i(t,{wide:""},{default:n(()=>[i(c,{justify:"center",gap:"16"},{default:n(()=>[(u(!0),A(Q,null,K(s(k),a=>(u(),m(L,{key:a.id,class:"pageGenerateLookstyle-item",onClick:o=>b(a.id)},{default:n(()=>{var o;return[i(v,{data:a,current:a.id===((o=s(f))==null?void 0:o.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in e?e.useRuntimeConfig:s(w))().public.DEV_ENABLED&&("useRuntimeConfig"in e?e.useRuntimeConfig:s(w))().public.ENVIRONMENT==="local"?(u(),m(L,{key:0,class:"pageGenerateLookstyle-item",onClick:h},{default:n(()=>{var a;return[i(v,{data:r,current:r.id===((a=s(f))==null?void 0:a.id)},null,8,["current"])]}),_:1})):B("",!0)]),_:1})]),_:1})]),_:1})}}});export{de as default};
