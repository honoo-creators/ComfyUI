import{ab as R,p as N,n as A,ak as G,ae as T,aD as y,s as C,af as v,ah as B,ai as D,ac as _,w as n,G as $,o as m,a as r,H as j,aB as O,J as F,c as P,am as U,az as V,aW as J,u as i,v as x,aI as b,l as h,m as g,b6 as I}from"./CYKOqXWh.js";import{L as E}from"./D4ywD1HH.js";import"./B1YbgbLf.js";import"./0Va9kxg_.js";const K=R({__name:"lookstyle",setup(M){const p={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},w=I(),u=N(),{lookStyle:k}=A(u),d=G([]),L=t=>{const s=d.value.find(o=>o.id===t);s&&(u.setLookStyle(s),h().replace(g().GENERATE_UPLOAD))},S=async()=>{const t=await w.select(["json"]),s=t.blob,o=async a=>new Promise((l,c)=>{const e=new FileReader;e.onload=()=>l(e.result),e.onerror=()=>c(new Error("ファイルの読み込みに失敗しました")),e.readAsText(a)});try{const l=await(await fetch(s)).blob(),c=await o(l),e={...p,name:t.name.replace(".json","")};u.setLookStyle(e),u.setCustomWorkflow(JSON.parse(c)),h().push(g().GENERATE_UPLOAD)}catch(a){console.error("JSONの変換に失敗しました:",a)}};return T(async()=>{var t,s;if(!y().active)return C("利用プランが選択されていません。");try{const o=await v().template.lookStyle(((t=y().active)==null?void 0:t.id)??0);(s=o.list)!=null&&s.length&&(d.value=o.list.map(a=>({...a,thumbnail_path:""})))}catch(o){if(o instanceof B)D().error(o);else return C("ルックスタイルの取得に失敗しました。")}}),(t,s)=>{const o=j,a=x,l=F,c=$;return m(),_(c,{class:"pageGenerateLookstyle",gap:"28"},{default:n(()=>[r(o,null,{default:n(()=>[r(O,{icon:"colorSwatch",title:"ルックスタイルを選択してください",body:"プロジェクト専用のスタイルを選び、<br />作品の世界観を引き立てましょう。"})]),_:1}),r(o,{wide:""},{default:n(()=>[r(l,{justify:"center",gap:"8",split:"2"},{default:n(()=>[(m(!0),P(V,null,J(i(d),e=>(m(),_(a,{key:e.id,class:"pageGenerateLookstyle-item",onClick:f=>L(e.id)},{default:n(()=>{var f;return[r(E,{data:e,current:e.id===((f=i(k))==null?void 0:f.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in t?t.useRuntimeConfig:i(b))().public.DEV_ENABLED&&("useRuntimeConfig"in t?t.useRuntimeConfig:i(b))().public.ENVIRONMENT==="local"?(m(),_(a,{key:0,class:"pageGenerateLookstyle-item",onClick:S},{default:n(()=>{var e;return[r(E,{data:p,current:p.id===((e=i(k))==null?void 0:e.id)},null,8,["current"])]}),_:1})):U("",!0)]),_:1})]),_:1})]),_:1})}}});export{K as default};
