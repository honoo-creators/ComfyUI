import{d as T,r,k as b,$ as R,o as Q,S as W,P as X,g as d,f as N,Q as Y,aq as Z,G as q,m as x,p as I,w as $,H as ee,t as h,z as j,v as G,ar as H,h as V,l,ao as K,as as te,J as P,X as ae,K as ne,F as le,al as se,q as O,a as oe,O as ue,ak as ie,s as re,C as de,D as ce}from"./DRtnay5Q.js";const me=["autocomplete","maxlength"],pe={class:"input-label-inner"},fe={key:0,class:"input-label-required"},z="update:modelValue",ve="enter-key-down",U="valid",F="invalid",L="focus",A="blur",ge=T({__name:"Input",props:{name:{type:String,default:"field",required:!0},type:{type:String,default:"text"},label:{type:String,default:""},placeholder:{type:String,default:""},modelValue:{type:String,default:"",required:!0},autocomplete:{type:Boolean,default:!1},pattern:{type:String},patternMismatchMessage:{type:String,default:"入力形式が正しくありません。"},maxlength:{type:[Number,String]},limitlength:{type:[Number,String]},required:{type:Boolean,default:!1},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},noSpin:{type:Boolean,default:!1},validation:{type:String,default:"blur",validator:t=>["always","blur"].includes(t)}},emits:{[z]:t=>!0,[ve]:()=>!0,[U]:()=>!0,[F]:t=>!0,[L]:()=>!0,[A]:()=>!0},setup(t,{emit:m}){const{noOnlySpace:c}=H(),e=t,a=m,i=r("idle"),p=r(null),E=r(e.focus),f=r(!1),v=`input-${e.name}`,n=r(""),C=b(()=>({[`_${i.value}`]:!0,_focus:E.value,_input:u.value.length,_readonly:e.readonly,_noLabel:!e.label,_disabled:e.disabled,_noSpin:e.noSpin})),u=b({get:()=>e.modelValue,set:o=>{a(z,o)}});R(()=>e.modelValue,()=>{(e.validation==="always"||n.value)&&s()});const S=()=>{},y=()=>{},w=()=>{E.value=!0,a(L)},g=()=>{e.validation==="blur"&&s(),E.value=!1,a(A)},s=()=>{let o="";u.value===""&&e.required&&(o=`${e.label?`${e.label}を`:`${e.placeholder}を`}入力してください。`),!o&&e.maxlength&&u.value.length>Number.parseInt(String(e.maxlength))&&(o=`${e.maxlength}文字以内で入力してください。現在${u.value.length}文字です。`),!o&&u.value!==""&&u.value.match(c)&&(o="空白のみの入力はできません。"),!o&&e.pattern&&!new RegExp(e.pattern).test(u.value)&&(o=e.patternMismatchMessage),u.value===""&&!e.required&&(o=""),o?(i.value="invalid",a(F,o),n.value=o):(i.value="valid",a(U),n.value="")};return Q(async()=>{await W(),u.value&&s()}),(o,_)=>{const M=X("focus");return d(),N("div",{class:G(["input",C.value])},[Y(q("input",x({id:v,ref_key:"fieldEl",ref:p,"onUpdate:modelValue":_[0]||(_[0]=k=>u.value=k),class:"input-field"},{type:t.type,name:t.name,placeholder:t.placeholder,required:t.required,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autocomplete,pattern:t.pattern,maxlength:t.maxlength},{autocomplete:t.autocomplete?"on":"off",maxlength:t.limitlength,onInput:S,onKeydown:y,onFocus:w,onBlur:g,onMouseover:_[1]||(_[1]=k=>f.value=!0),onMouseleave:_[2]||(_[2]=k=>f.value=!1)}),null,16,me),[[Z,u.value],[M,t.focus]]),t.label?(d(),I(j,{key:0,tag:"label",for:v,class:"input-label"},{default:$(()=>[q("span",pe,ee(t.label),1),t.required?(d(),N("span",fe,"*")):h("",!0)]),_:1})):h("",!0)],2)}}}),ye=()=>({INVITE_CODE_LENGTH:16}),_e=T({__name:"EnterpriseCodeInput",props:{modelValue:{type:String,default:"",required:!0},status:{type:String,default:"",validator:t=>["","progress","ok","ng"].includes(t)},message:{type:String,default:""}},emits:["update:modelValue","valid","invalid","focus","blur"],setup(t,{emit:m}){const{INVITE_CODE_LENGTH:c}=ye(),{upperCaseAlphanumericPattern:e}=H(),a=t,i=m,p=r(""),E=b(()=>({[`_${a.status}`]:!0})),f=b({get:()=>a.modelValue,set:g=>{i("update:modelValue",g)}}),v=b(()=>a.status==="ok"?"招待コードを確認しました。":a.status==="ng"?"":`半角英数字${c}桁で入力してください。`),n=b(()=>a.status==="progress"),C=b(()=>a.status==="progress"||a.status==="ok"),u=b(()=>a.status==="ng"),S=()=>{p.value="",i("valid")},y=()=>{p.value=`半角英数字${c}桁で入力してください。`,i("invalid")},w=g=>{const s=g.target;s.value=s.value.toUpperCase(),f.value=s.value,s.value.length===c?S():y()};return R(()=>a.message,g=>{g&&(p.value=g)}),(g,s)=>{const o=ge,_=te,M=P,k=ae,D=ne,J=j;return d(),I(J,{class:G(["enterpriseCodeInput",l(E)]),title2:""},{default:$(()=>[V(M,{justify:"center"},{default:$(()=>[V(o,x({modelValue:l(f),"onUpdate:modelValue":s[0]||(s[0]=B=>K(f)?f.value=B:null),class:"enterpriseCodeInput-field",name:"email",type:"email",label:"招待コード",placeholder:"",limitlength:l(c),validation:"always",pattern:l(e),required:""},{disabled:l(u),readonly:l(C)},{onValid:S,onInvalid:y,onFocus:s[1]||(s[1]=B=>i("focus")),onBlur:s[2]||(s[2]=B=>i("blur")),onInput:w}),null,16,["modelValue","limitlength","pattern"]),V(_,x({message:l(p),fail:t.status==="ng"},{description:l(v)}),null,16,["message","fail"])]),_:1}),l(n)?(d(),I(k,{key:0,class:"enterpriseCodeInput-icon",size:"16",color:"dark60"})):t.status==="ok"?(d(),I(D,{key:1,class:"enterpriseCodeInput-icon",name:"check",size:"16",color:"success"})):t.status==="ng"?(d(),I(D,{key:2,class:"enterpriseCodeInput-icon",name:"cross",size:"16",color:"danger"})):h("",!0)]),_:1},8,["class"])}}}),be={class:"pageJoin"},Ee=T({__name:"join",setup(t){const m=r(""),c=r(!1),e=r(""),a=r(""),i=r(!1),p=r(new Date().toISOString()),E=async()=>{c.value=!0,e.value="progress",a.value="";try{const{organization_id:v,organization_name:n}=await oe().member.join.organization(m.value);await ue().open({name:"joinOrganization",options:{id:v,name:n}})}catch(v){if(e.value="ng",a.value="無効な招待コードです。",!(v instanceof ie))return re({statusCode:Number(de.UnknownError),statusMessage:"不明なエラーが発生しました。"})}finally{c.value=!1}},f=()=>{m.value="",e.value="",a.value="",i.value=!1,p.value=new Date().toISOString()};return(v,n)=>{const C=ce,u=P,S=le;return d(),N("div",be,[V(S,{narrow:""},{default:$(()=>[V(u,{class:"pageGenerateConfirm",gap:"28"},{default:$(()=>[V(se,{icon:"code",title:"追加するコードをご入力ください"}),(d(),I(_e,x({key:l(p),modelValue:l(m),"onUpdate:modelValue":n[0]||(n[0]=y=>K(m)?m.value=y:null)},{status:l(e),message:l(a)},{onValid:n[1]||(n[1]=y=>i.value=!0),onInvalid:n[2]||(n[2]=y=>i.value=!1)}),null,16,["modelValue"])),l(e)!=="ng"?(d(),I(C,{key:0,disabled:!l(i),loading:l(c),onClick:E},{default:$(()=>n[3]||(n[3]=[O(" 送信 ")])),_:1},8,["disabled","loading"])):h("",!0),l(e)==="ng"?(d(),I(C,{key:1,onClick:f},{default:$(()=>n[4]||(n[4]=[O(" クリア ")])),_:1})):h("",!0)]),_:1})]),_:1})])}}});export{Ee as default};
