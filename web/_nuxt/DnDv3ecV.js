import{d as L,aC as x,al as A,x as G,o as $,aa as f,s as k,a as j,ai as v,ah as R,f as p,i as y,w as l,z as r,g as T,G as F,Y as d,F as N,aD as h,e as b,c as C,V as U,t as B,U as D,a1 as O}from"./DHmO57dV.js";import{_ as P}from"./Bwu0yGje.js";import{_ as g}from"./D8VxtXLW.js";import"./8uezsCuj.js";import"./oDp7R59H.js";import"./D4g9ZAQC.js";const H=L({__name:"lookstyle",setup(J){const u={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},w=O(),i=x(),{lookStyle:m}=A(i),_=G([]),E=s=>{const a=_.value.find(e=>e.id===s);a&&(i.setLookStyle(a),b().push(C().GENERATE_UPLOAD))},S=async()=>{const s=await w.select(["json"]),a=s.blob,e=async n=>new Promise((c,t)=>{const o=new FileReader;o.onload=()=>c(o.result),o.onerror=()=>t(new Error("ファイルの読み込みに失敗しました")),o.readAsText(n)});try{const c=await(await fetch(a)).blob(),t=await e(c),o={...u,name:s.name.replace(".json","")};i.setLookStyle(o),i.setCustomWorkflow(JSON.parse(t)),b().push(C().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return $(async()=>{var s,a;if(!f().active)return k("利用プランが選択されていません。");try{const e=await j().template.lookStyle(((s=f().active)==null?void 0:s.id)??0);(a=e.list)!=null&&a.length&&(_.value=e.list.map(n=>({...n,thumbnail_path:"/nuxt/assets/lookstyle/honoo_bgart_v04.jpg"})))}catch(e){if(e instanceof v)R().error(e);else return k("背景美術スタイルの取得に失敗しました。")}}),(s,a)=>{const e=U,n=B,c=D;return p(),y(c,{class:"pageGenerateLookstyle",gap:"28"},{default:l(()=>[r(e,null,{default:l(()=>[r(P,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),r(e,{wide:""},{default:l(()=>[r(n,{justify:"center",gap:"16"},{default:l(()=>[(p(!0),T(N,null,F(d(_),t=>(p(),y(h,{key:t.id,class:"pageGenerateLookstyle-item",onClick:o=>E(t.id)},{default:l(()=>{var o;return[r(g,{data:t,current:t.id===((o=d(m))==null?void 0:o.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),r(h,{class:"pageGenerateLookstyle-item",onClick:S},{default:l(()=>{var t;return[r(g,{data:u,current:u.id===((t=d(m))==null?void 0:t.id)},null,8,["current"])]}),_:1})]),_:1})]),_:1})]),_:1})}}});export{H as default};
