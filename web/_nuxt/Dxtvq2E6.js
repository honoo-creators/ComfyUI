import{d as B,a4 as R,h as V,c as O,o as r,a as i,w as t,k as n,Q as e,f as u,l as m,t as N,ad as b,Z as $,S as J,T as M,ae as P,af as Q,N as F,M as L,_ as Y,an as q,g as z,V as Z,ao as H,Y as K}from"./D3Ft7b30.js";import{_ as W}from"./C92Hx70b.js";import{_ as X}from"./C1_tAsdV.js";import{_ as ee,a as d}from"./BqeEZXu3.js";import{u as ae}from"./Dtgm3dlD.js";import"./CMxr5Fhd.js";import"./fj9P_T4i.js";import"./DmolMG9N.js";const me=B({__name:"generate-confirm",setup(te){const{lookStyle:k,base64:p,imageFile:I,promptA:f,promptB:_,promptC:g,promptD:y,workflow:T}=ae(),{face:U,name:j,ticket:C}=R(),w=H(),E=K(),h=V(!1),D=O(()=>$().public.COMFYUI_GENERATE_ENABLED),S=()=>{b().alert({title:"ComfyUI Queue Disabled",message:"この環境では画像生成が許可されていません。",icon:"prohibited"})},v=async()=>{h.value=!0;let c={};try{if($().public.ENVIRONMENT==="local"){c=T;const{name:a}=await E.upload.image(I);"nodes"in c&&c.nodes.forEach(o=>{if(typeof o=="object"&&o!==null&&"type"in o&&"widgets_values"in o){const s=o;s.type==="LoadImage"&&(s.widgets_values=s.widgets_values.map(l=>typeof l=="string"?a:l))}})}else{const{original_image_id:a}=await w.upload.originalImage(p);c=await w.template.getJsonTemplate({version:1,backgroundArtStyleId:2,prompt:[f,_,g,y].join(" "),retry_count:0,original_image_id:a})}await E.queuePrompt({json:JSON.stringify(c),batchCount:1}),J().push(M().OUTPUT)}catch(a){h.value=!1,a instanceof P?b().error(a):b().error({title:"Generate Error",message:"生成に失敗しました。",icon:"exclamation",button:"閉じる",code:Q.UnknownError,name:"UnknownError"})}};return(c,a)=>{const o=F,s=L,l=Y,x=q,A=z,G=Z;return r(),i(s,{class:"pageGenerateConfirm",gap:"28"},{default:t(()=>[n(o,null,{default:t(()=>[n(W,{icon:"document",title:"設定内容の確認",body:"設定内容をご確認ください"})]),_:1}),n(o,null,{default:t(()=>[n(s,{justify:"stretch",gap:"32"},{default:t(()=>[n(s,{justify:"stretch",gap:"8"},{default:t(()=>[e(k)?(r(),i(X,{key:0,class:"pageGenerateConfirm-lookstyle",data:e(k)},null,8,["data"])):u("",!0),e(p)?(r(),i(ee,{key:1,data:e(p)},null,8,["data"])):u("",!0),e(f)?(r(),i(d,{key:2,data:e(f),name:"何を描くか"},null,8,["data"])):u("",!0),e(_)?(r(),i(d,{key:3,data:e(_),name:"周りの環境"},null,8,["data"])):u("",!0),e(g)?(r(),i(d,{key:4,data:e(g),name:"色調・ムード"},null,8,["data"])):u("",!0),e(y)?(r(),i(d,{key:5,data:e(y),name:"ライティング"},null,8,["data"])):u("",!0)]),_:1}),n(l,{title3:"",center:""},{default:t(()=>a[0]||(a[0]=[m(" 上記の設定で背景美術を生成します。 ")])),_:1}),n(s,{justify:"center",gap:"8"},{default:t(()=>[n(x,{src:e(U),size:"72"},null,8,["src"]),n(l,{headline:"",extrabold:"",center:""},{default:t(()=>[m(N(e(j)),1)]),_:1}),e(C)!==1/0?(r(),i(A,{key:0,justify:"center",align:"end",gap:"1",nowrap:""},{default:t(()=>[n(l,{body:"",bold:"","baseline-height":""},{default:t(()=>[m(N(e(C)),1)]),_:1}),n(l,{caption2:"",bold:"","baseline-height":""},{default:t(()=>a[1]||(a[1]=[m(" チケット ")])),_:1})]),_:1})):u("",!0)]),_:1}),n(G,{disabled:!e(D),onClick:v,onDisabledClick:S},{default:t(()=>a[2]||(a[2]=[m(" 生成する ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}});export{me as default};
