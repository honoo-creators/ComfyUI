import{d as gt,aD as Je,x as yt,h as It,f as Te,i as Se,w as ve,z as be,Y as se,l as Re,A as et,ah as Ke,$ as We,aG as At,e as _t,c as tt,ai as vt,C as bt,n as wt,V as Nt,U as Et,a2 as Ct,a as kt,a5 as Tt}from"./CfVUTS_E.js";import{_ as St}from"./DLyx5tMN.js";import{_ as xt}from"./DfK6wnE9.js";import{_ as Ot,a as Ge}from"./CQLGYnvT.js";import"./zNum1Mc4.js";import"./CmHsN-H6.js";const Rt=1556,Lt=3808,Ut=[{id:1101,type:"ImpactKSamplerBasicPipe",pos:[-2388.449951171875,568.0198364257812],size:[370,570],flags:{},order:15,mode:0,inputs:[{name:"basic_pipe",type:"BASIC_PIPE",link:2816},{name:"latent_image",type:"LATENT",link:3802},{name:"scheduler_func_opt",type:"SCHEDULER_FUNC",link:null,shape:7}],outputs:[{name:"BASIC_PIPE",type:"BASIC_PIPE",links:[],slot_index:0,shape:3},{name:"LATENT",type:"LATENT",links:[2814],slot_index:1,shape:3},{name:"VAE",type:"VAE",links:null,shape:3}],properties:{"Node name for S&R":"ImpactKSamplerBasicPipe"},widgets_values:[555639338001183,"randomize",40,7,"euler_ancestral","karras",1],color:"#223",bgcolor:"#335",shape:1},{id:904,type:"CR Prompt Text",pos:[-4226.4716796875,737.9478759765625],size:[450,220],flags:{},order:0,mode:0,inputs:[],outputs:[{name:"prompt",type:"STRING",links:[3131],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],title:"Positive Prompt",properties:{"Node name for S&R":"CR Prompt Text"},widgets_values:[`(beautiful modern Japanese Anime background art for anime film, cinematic, epic, realistic, sharp details, dramatic lighting:1.3),

(volume light source at top middle of the frame:1.3),

old elementary school building,
a schoolyard,
succor field and goals,
gymnasium,
countryside,
in Japan,
the wooded hill behind the school,
beautiful mountains,
blue sky,
white summer clouds,
sunny day,
around noon,
in summer,`],color:"#232",bgcolor:"#353",shape:1},{id:625,type:"ToBasicPipe",pos:[-2738.45068359375,558.019775390625],size:[320,110],flags:{collapsed:!1},order:14,mode:0,inputs:[{name:"model",type:"MODEL",link:3792},{name:"clip",type:"CLIP",link:3793},{name:"vae",type:"VAE",link:3781},{name:"positive",type:"CONDITIONING",link:3381},{name:"negative",type:"CONDITIONING",link:2545}],outputs:[{name:"basic_pipe",type:"BASIC_PIPE",links:[2816],slot_index:0,shape:3}],properties:{"Node name for S&R":"ToBasicPipe"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:600,type:"Apply ControlNet Stack",pos:[-3068.45068359375,608.0198974609375],size:[300,70],flags:{collapsed:!1},order:13,mode:0,inputs:[{name:"positive",type:"CONDITIONING",link:3794},{name:"negative",type:"CONDITIONING",link:3773},{name:"cnet_stack",type:"CONTROL_NET_STACK",link:3772,shape:7}],outputs:[{name:"CONDITIONING+",type:"CONDITIONING",links:[3381],slot_index:0,shape:3},{name:"CONDITIONING-",type:"CONDITIONING",links:[2545],slot_index:1,shape:3}],properties:{"Node name for S&R":"Apply ControlNet Stack"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:639,type:"VAELoader",pos:[-4226.4716796875,597.9478759765625],size:[450,60],flags:{},order:1,mode:0,inputs:[],outputs:[{name:"VAE",type:"VAE",links:[3781,3783],slot_index:0,shape:3}],properties:{"Node name for S&R":"VAELoader"},widgets_values:["SDXL/sdxl_vae.safetensors"],color:"#232",bgcolor:"#353",shape:1},{id:498,type:"VAEDecode",pos:[-1975.650634765625,584.0463256835938],size:[210,50],flags:{collapsed:!1},order:16,mode:0,inputs:[{name:"samples",type:"LATENT",link:2814},{name:"vae",type:"VAE",link:3783}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3784],slot_index:0,shape:3}],properties:{"Node name for S&R":"VAEDecode"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:344,type:"SaveImage",pos:[-1725.6512451171875,564.0463256835938],size:[910,1160],flags:{},order:17,mode:0,inputs:[{name:"images",type:"IMAGE",link:3784}],outputs:[],properties:{"Node name for S&R":"SaveImage"},widgets_values:["animeBG3/abg3"],color:"#223",bgcolor:"#335",shape:1},{id:1249,type:"LoadImage",pos:[-5624.43701171875,620.7802124023438],size:[430,450],flags:{pinned:!1},order:2,mode:0,inputs:[],outputs:[{name:"IMAGE",type:"IMAGE",links:[3189],slot_index:0,shape:3},{name:"MASK",type:"MASK",links:null,slot_index:1,shape:3}],title:"Image for ControlNet",properties:{"Node name for S&R":"LoadImage_controlnet"},widgets_values:["","image"],color:"#323",bgcolor:"#535",shape:1},{id:907,type:"CR Prompt Text",pos:[-4226.4716796875,1007.9478759765625],size:[450,150],flags:{},order:3,mode:0,inputs:[],outputs:[{name:"prompt",type:"STRING",links:[2399],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],title:"Negative Prompt",properties:{"Node name for S&R":"CR Prompt Text"},widgets_values:["fantasy, sci-fi, blurred, (lighting effects:1.3), two key-light sources, depth of field, outlines, sunset, morning light, Chinese culture, black and white, monochrome, "],color:"#232",bgcolor:"#353",shape:1},{id:1250,type:"DF_Image_scale_to_side",pos:[-5154.43701171875,630.7802734375],size:[360,140],flags:{collapsed:!1},order:5,mode:0,inputs:[{name:"image",type:"IMAGE",link:3189}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3787,3808],slot_index:0,shape:3}],properties:{"Node name for S&R":"DF_Image_scale_to_side"},widgets_values:[1216,"Longest","nearest-exact","disabled"],color:"#323",bgcolor:"#535",shape:1},{id:1276,type:"AIO_Preprocessor",pos:[-5110.01611328125,835.6531372070312],size:[320,80],flags:{},order:7,mode:0,inputs:[{name:"image",type:"IMAGE",link:3787}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3786],slot_index:0,shape:3}],properties:{"Node name for S&R":"AIO_Preprocessor"},widgets_values:["TEEDPreprocessor",1216],color:"#323",bgcolor:"#535",shape:1},{id:1271,type:"CR Multi-ControlNet Stack",pos:[-4710.01611328125,605.6531372070312],size:[410,460],flags:{collapsed:!1},order:11,mode:0,inputs:[{name:"image_1",type:"IMAGE",link:3786,shape:7},{name:"image_2",type:"IMAGE",link:null,shape:7},{name:"image_3",type:"IMAGE",link:null,shape:7},{name:"controlnet_stack",type:"CONTROL_NET_STACK",link:null,shape:7}],outputs:[{name:"CONTROLNET_STACK",type:"CONTROL_NET_STACK",links:[3772],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],properties:{"Node name for S&R":"CR Multi-ControlNet Stack"},widgets_values:["On","mistoLine_rank256.safetensors",.9500000000000001,0,.9500000000000001,"Off","control-lora-depth-rank256.safetensors",.6,0,.8,"Off","control-lora-depth-rank256.safetensors",.85,0,.966],color:"#323",bgcolor:"#535",shape:1},{id:1556,type:"GetImageSizeAndCount",pos:[-4226.4716796875,1207.9478759765625],size:[280,90],flags:{},order:8,mode:0,inputs:[{name:"image",type:"IMAGE",link:3808}],outputs:[{name:"image",type:"IMAGE",links:null},{name:"1216 width",type:"INT",links:[3805],slot_index:1},{name:"861 height",type:"INT",links:[3806],slot_index:2},{name:"1 count",type:"INT",links:null}],properties:{"Node name for S&R":"GetImageSizeAndCount"}},{id:1552,type:"SDXLEmptyLatentSizePicker+",pos:[-3916.47265625,1217.9478759765625],size:[340,170],flags:{},order:12,mode:0,inputs:[{name:"width_override",type:"INT",link:3805,widget:{name:"width_override"}},{name:"height_override",type:"INT",link:3806,widget:{name:"height_override"}}],outputs:[{name:"LATENT",type:"LATENT",links:[3802],slot_index:0},{name:"width",type:"INT",links:null},{name:"height",type:"INT",links:null}],properties:{"Node name for S&R":"SDXLEmptyLatentSizePicker+"},widgets_values:["1024x1024 (1.0)",1,0,0]},{id:794,type:"CheckpointLoaderSimple",pos:[-4226.4716796875,417.9479675292969],size:[450,100],flags:{},order:4,mode:0,inputs:[],outputs:[{name:"MODEL",type:"MODEL",links:[3792],slot_index:0,shape:3},{name:"CLIP",type:"CLIP",links:[3693],slot_index:1,shape:3},{name:"VAE",type:"VAE",links:[],slot_index:2,shape:3}],properties:{"Node name for S&R":"CheckpointLoaderSimple"},widgets_values:["HONOO-anime-BG_01_.safetensors"],color:"#232",bgcolor:"#353",shape:1},{id:1198,type:"CLIPSetLastLayer",pos:[-3736.47265625,437.9479675292969],size:[220,60],flags:{},order:6,mode:0,inputs:[{name:"clip",type:"CLIP",link:3693}],outputs:[{name:"CLIP",type:"CLIP",links:[3776,3777,3793],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPSetLastLayer"},widgets_values:[-1],color:"#232",bgcolor:"#353",shape:1},{id:1224,type:"CLIPTextEncode",pos:[-3396.47265625,617.9478759765625],size:[210,80],flags:{collapsed:!1},order:9,mode:0,inputs:[{name:"clip",type:"CLIP",link:3776},{name:"text",type:"STRING",link:3131,widget:{name:"text"}}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[3794],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPTextEncode"},widgets_values:["(Accordion cable:1.4). (mechanical details:1.5), (outlines:1.2),  fog, photorealism, worst quality, (trees, plants, green, grass:1.3), text, watermark, nude"],color:"#232",bgcolor:"#353",shape:1},{id:896,type:"CLIPTextEncode",pos:[-3396.47265625,747.9478759765625],size:[210,70],flags:{collapsed:!1},order:10,mode:0,inputs:[{name:"clip",type:"CLIP",link:3777},{name:"text",type:"STRING",link:2399,widget:{name:"text"}}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[3773],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPTextEncode"},widgets_values:["(Accordion cable:1.4). (mechanical details:1.5), (outlines:1.2),  fog, photorealism, worst quality, (trees, plants, green, grass:1.3), text, watermark, nude"],color:"#232",bgcolor:"#353",shape:1}],Pt=[[2399,907,0,896,1,"STRING"],[2545,600,1,625,4,"CONDITIONING"],[2814,1101,1,498,0,"LATENT"],[2816,625,0,1101,0,"BASIC_PIPE"],[3131,904,0,1224,1,"STRING"],[3189,1249,0,1250,0,"IMAGE"],[3381,600,0,625,3,"CONDITIONING"],[3693,794,1,1198,0,"CLIP"],[3772,1271,0,600,2,"CONTROL_NET_STACK"],[3773,896,0,600,1,"CONDITIONING"],[3776,1198,0,1224,0,"CLIP"],[3777,1198,0,896,0,"CLIP"],[3781,639,0,625,2,"VAE"],[3783,639,0,498,1,"VAE"],[3784,498,0,344,0,"IMAGE"],[3786,1276,0,1271,0,"IMAGE"],[3787,1250,0,1276,0,"IMAGE"],[3792,794,0,625,0,"MODEL"],[3793,1198,0,625,1,"CLIP"],[3794,1224,0,600,0,"CONDITIONING"],[3802,1552,0,1101,1,"LATENT"],[3805,1556,1,1552,0,"INT"],[3806,1556,2,1552,1,"INT"],[3808,1250,0,1556,0,"IMAGE"]],Mt=[{id:5,title:"Txt2Img（テキストから描画）",bounding:[-4236.4716796875,344.34796142578125,1060,1053.5999755859375],color:"#b0b0b0",font_size:24,flags:{}},{id:6,title:"KSampler（描画）",bounding:[-3078.45068359375,484.4197082519531,2272.801025390625,1249.6265869140625],color:"#b0b0b0",font_size:24,flags:{}},{id:11,title:"ControlNet",bounding:[-5634.43701171875,532.0531005859375,1344.4208984375,548.72705078125],color:"#ababab",font_size:24,flags:{}}],Gt={},Ft={ds:{scale:.6303940863128702,offset:[4503.910996535225,-129.597771250219]},groupNodes:{}},Dt=.4,zt={last_node_id:Rt,last_link_id:Lt,nodes:Ut,links:Pt,groups:Mt,config:Gt,extra:Ft,version:Dt},Bt=1556,Ht=3808,Vt=[{id:1101,type:"ImpactKSamplerBasicPipe",pos:[-2388.449951171875,568.0198364257812],size:[370,570],flags:{},order:15,mode:0,inputs:[{name:"basic_pipe",type:"BASIC_PIPE",link:2816},{name:"latent_image",type:"LATENT",link:3802},{name:"scheduler_func_opt",type:"SCHEDULER_FUNC",link:null,shape:7}],outputs:[{name:"BASIC_PIPE",type:"BASIC_PIPE",links:[],slot_index:0,shape:3},{name:"LATENT",type:"LATENT",links:[2814],slot_index:1,shape:3},{name:"VAE",type:"VAE",links:null,shape:3}],properties:{"Node name for S&R":"ImpactKSamplerBasicPipe"},widgets_values:[555639338001183,"randomize",40,7,"euler_ancestral","karras",1],color:"#223",bgcolor:"#335",shape:1},{id:904,type:"CR Prompt Text",pos:[-4226.4716796875,737.9478759765625],size:[450,220],flags:{},order:0,mode:0,inputs:[],outputs:[{name:"prompt",type:"STRING",links:[3131],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],title:"Positive Prompt",properties:{"Node name for S&R":"CR Prompt Text"},widgets_values:[`(beautiful modern Japanese Anime background art for anime film, cinematic, epic, realistic, sharp details, dramatic lighting:1.3),

(volume light source at top middle of the frame:1.3),

old elementary school building,
a schoolyard,
succor field and goals,
gymnasium,
countryside,
in Japan,
the wooded hill behind the school,
beautiful mountains,
blue sky,
white summer clouds,
sunny day,
around noon,
in summer,`],color:"#232",bgcolor:"#353",shape:1},{id:625,type:"ToBasicPipe",pos:[-2738.45068359375,558.019775390625],size:[320,110],flags:{collapsed:!1},order:14,mode:0,inputs:[{name:"model",type:"MODEL",link:3792},{name:"clip",type:"CLIP",link:3793},{name:"vae",type:"VAE",link:3781},{name:"positive",type:"CONDITIONING",link:3381},{name:"negative",type:"CONDITIONING",link:2545}],outputs:[{name:"basic_pipe",type:"BASIC_PIPE",links:[2816],slot_index:0,shape:3}],properties:{"Node name for S&R":"ToBasicPipe"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:600,type:"Apply ControlNet Stack",pos:[-3068.45068359375,608.0198974609375],size:[300,70],flags:{collapsed:!1},order:13,mode:0,inputs:[{name:"positive",type:"CONDITIONING",link:3794},{name:"negative",type:"CONDITIONING",link:3773},{name:"cnet_stack",type:"CONTROL_NET_STACK",link:3772,shape:7}],outputs:[{name:"CONDITIONING+",type:"CONDITIONING",links:[3381],slot_index:0,shape:3},{name:"CONDITIONING-",type:"CONDITIONING",links:[2545],slot_index:1,shape:3}],properties:{"Node name for S&R":"Apply ControlNet Stack"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:639,type:"VAELoader",pos:[-4226.4716796875,597.9478759765625],size:[450,60],flags:{},order:1,mode:0,inputs:[],outputs:[{name:"VAE",type:"VAE",links:[3781,3783],slot_index:0,shape:3}],properties:{"Node name for S&R":"VAELoader"},widgets_values:["sdxl_vae.safetensors"],color:"#232",bgcolor:"#353",shape:1},{id:498,type:"VAEDecode",pos:[-1975.650634765625,584.0463256835938],size:[210,50],flags:{collapsed:!1},order:16,mode:0,inputs:[{name:"samples",type:"LATENT",link:2814},{name:"vae",type:"VAE",link:3783}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3784],slot_index:0,shape:3}],properties:{"Node name for S&R":"VAEDecode"},widgets_values:[],color:"#223",bgcolor:"#335",shape:1},{id:344,type:"SaveImage",pos:[-1725.6512451171875,564.0463256835938],size:[910,1160],flags:{},order:17,mode:0,inputs:[{name:"images",type:"IMAGE",link:3784}],outputs:[],properties:{"Node name for S&R":"SaveImage"},widgets_values:["animeBG3/abg3"],color:"#223",bgcolor:"#335",shape:1},{id:1249,type:"LoadImage",pos:[-5624.43701171875,620.7802124023438],size:[430,450],flags:{pinned:!1},order:2,mode:0,inputs:[],outputs:[{name:"IMAGE",type:"IMAGE",links:[3189],slot_index:0,shape:3},{name:"MASK",type:"MASK",links:null,slot_index:1,shape:3}],title:"Image for ControlNet",properties:{"Node name for S&R":"LoadImage_controlnet"},widgets_values:["","image"],color:"#323",bgcolor:"#535",shape:1},{id:907,type:"CR Prompt Text",pos:[-4226.4716796875,1007.9478759765625],size:[450,150],flags:{},order:3,mode:0,inputs:[],outputs:[{name:"prompt",type:"STRING",links:[2399],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],title:"Negative Prompt",properties:{"Node name for S&R":"CR Prompt Text"},widgets_values:["fantasy, sci-fi, blurred, (lighting effects:1.3), two key-light sources, depth of field, outlines, sunset, morning light, Chinese culture, black and white, monochrome, "],color:"#232",bgcolor:"#353",shape:1},{id:1250,type:"DF_Image_scale_to_side",pos:[-5154.43701171875,630.7802734375],size:[360,140],flags:{collapsed:!1},order:5,mode:0,inputs:[{name:"image",type:"IMAGE",link:3189}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3787,3808],slot_index:0,shape:3}],properties:{"Node name for S&R":"DF_Image_scale_to_side"},widgets_values:[1216,"Longest","nearest-exact","disabled"],color:"#323",bgcolor:"#535",shape:1},{id:1276,type:"AIO_Preprocessor",pos:[-5110.01611328125,835.6531372070312],size:[320,80],flags:{},order:7,mode:0,inputs:[{name:"image",type:"IMAGE",link:3787}],outputs:[{name:"IMAGE",type:"IMAGE",links:[3786],slot_index:0,shape:3}],properties:{"Node name for S&R":"AIO_Preprocessor"},widgets_values:["TEEDPreprocessor",1216],color:"#323",bgcolor:"#535",shape:1},{id:1271,type:"CR Multi-ControlNet Stack",pos:[-4710.01611328125,605.6531372070312],size:[410,460],flags:{collapsed:!1},order:11,mode:0,inputs:[{name:"image_1",type:"IMAGE",link:3786,shape:7},{name:"image_2",type:"IMAGE",link:null,shape:7},{name:"image_3",type:"IMAGE",link:null,shape:7},{name:"controlnet_stack",type:"CONTROL_NET_STACK",link:null,shape:7}],outputs:[{name:"CONTROLNET_STACK",type:"CONTROL_NET_STACK",links:[3772],slot_index:0,shape:3},{name:"show_help",type:"STRING",links:null,shape:3}],properties:{"Node name for S&R":"CR Multi-ControlNet Stack"},widgets_values:["On","mistoLine_rank256.safetensors",.9500000000000001,0,.9500000000000001,"Off","control-lora-depth-rank256.safetensors",.6,0,.8,"Off","control-lora-depth-rank256.safetensors",.85,0,.966],color:"#323",bgcolor:"#535",shape:1},{id:1556,type:"GetImageSizeAndCount",pos:[-4226.4716796875,1207.9478759765625],size:[280,90],flags:{},order:8,mode:0,inputs:[{name:"image",type:"IMAGE",link:3808}],outputs:[{name:"image",type:"IMAGE",links:null},{name:"1216 width",type:"INT",links:[3805],slot_index:1},{name:"861 height",type:"INT",links:[3806],slot_index:2},{name:"1 count",type:"INT",links:null}],properties:{"Node name for S&R":"GetImageSizeAndCount"}},{id:1552,type:"SDXLEmptyLatentSizePicker+",pos:[-3916.47265625,1217.9478759765625],size:[340,170],flags:{},order:12,mode:0,inputs:[{name:"width_override",type:"INT",link:3805,widget:{name:"width_override"}},{name:"height_override",type:"INT",link:3806,widget:{name:"height_override"}}],outputs:[{name:"LATENT",type:"LATENT",links:[3802],slot_index:0},{name:"width",type:"INT",links:null},{name:"height",type:"INT",links:null}],properties:{"Node name for S&R":"SDXLEmptyLatentSizePicker+"},widgets_values:["1024x1024 (1.0)",1,0,0]},{id:794,type:"CheckpointLoaderSimple",pos:[-4226.4716796875,417.9479675292969],size:[450,100],flags:{},order:4,mode:0,inputs:[],outputs:[{name:"MODEL",type:"MODEL",links:[3792],slot_index:0,shape:3},{name:"CLIP",type:"CLIP",links:[3693],slot_index:1,shape:3},{name:"VAE",type:"VAE",links:[],slot_index:2,shape:3}],properties:{"Node name for S&R":"CheckpointLoaderSimple"},widgets_values:["HONOO-anime-BG_01_.safetensors"],color:"#232",bgcolor:"#353",shape:1},{id:1198,type:"CLIPSetLastLayer",pos:[-3736.47265625,437.9479675292969],size:[220,60],flags:{},order:6,mode:0,inputs:[{name:"clip",type:"CLIP",link:3693}],outputs:[{name:"CLIP",type:"CLIP",links:[3776,3777,3793],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPSetLastLayer"},widgets_values:[-1],color:"#232",bgcolor:"#353",shape:1},{id:1224,type:"CLIPTextEncode",pos:[-3396.47265625,617.9478759765625],size:[210,80],flags:{collapsed:!1},order:9,mode:0,inputs:[{name:"clip",type:"CLIP",link:3776},{name:"text",type:"STRING",link:3131,widget:{name:"text"}}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[3794],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPTextEncode"},widgets_values:["(Accordion cable:1.4). (mechanical details:1.5), (outlines:1.2),  fog, photorealism, worst quality, (trees, plants, green, grass:1.3), text, watermark, nude"],color:"#232",bgcolor:"#353",shape:1},{id:896,type:"CLIPTextEncode",pos:[-3396.47265625,747.9478759765625],size:[210,70],flags:{collapsed:!1},order:10,mode:0,inputs:[{name:"clip",type:"CLIP",link:3777},{name:"text",type:"STRING",link:2399,widget:{name:"text"}}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[3773],slot_index:0,shape:3}],properties:{"Node name for S&R":"CLIPTextEncode"},widgets_values:["(Accordion cable:1.4). (mechanical details:1.5), (outlines:1.2),  fog, photorealism, worst quality, (trees, plants, green, grass:1.3), text, watermark, nude"],color:"#232",bgcolor:"#353",shape:1}],$t=[[2399,907,0,896,1,"STRING"],[2545,600,1,625,4,"CONDITIONING"],[2814,1101,1,498,0,"LATENT"],[2816,625,0,1101,0,"BASIC_PIPE"],[3131,904,0,1224,1,"STRING"],[3189,1249,0,1250,0,"IMAGE"],[3381,600,0,625,3,"CONDITIONING"],[3693,794,1,1198,0,"CLIP"],[3772,1271,0,600,2,"CONTROL_NET_STACK"],[3773,896,0,600,1,"CONDITIONING"],[3776,1198,0,1224,0,"CLIP"],[3777,1198,0,896,0,"CLIP"],[3781,639,0,625,2,"VAE"],[3783,639,0,498,1,"VAE"],[3784,498,0,344,0,"IMAGE"],[3786,1276,0,1271,0,"IMAGE"],[3787,1250,0,1276,0,"IMAGE"],[3792,794,0,625,0,"MODEL"],[3793,1198,0,625,1,"CLIP"],[3794,1224,0,600,0,"CONDITIONING"],[3802,1552,0,1101,1,"LATENT"],[3805,1556,1,1552,0,"INT"],[3806,1556,2,1552,1,"INT"],[3808,1250,0,1556,0,"IMAGE"]],Qt=[{id:5,title:"Txt2Img（テキストから描画）",bounding:[-4236.4716796875,344.34796142578125,1060,1053.5999755859375],color:"#b0b0b0",font_size:24,flags:{}},{id:6,title:"KSampler（描画）",bounding:[-3078.45068359375,484.4197082519531,2272.801025390625,1249.6265869140625],color:"#b0b0b0",font_size:24,flags:{}},{id:11,title:"ControlNet",bounding:[-5634.43701171875,532.0531005859375,1344.4208984375,548.72705078125],color:"#ababab",font_size:24,flags:{}}],Kt={},Wt={ds:{scale:.6303940863128702,offset:[4503.910996535225,-129.597771250219]},groupNodes:{}},jt=.4,qt={last_node_id:Bt,last_link_id:Ht,nodes:Vt,links:$t,groups:Qt,config:Kt,extra:Wt,version:jt};function Xt(R,O){return O.forEach(function(G){G&&typeof G!="string"&&!Array.isArray(G)&&Object.keys(G).forEach(function(d){if(d!=="default"&&!(d in R)){var e=Object.getOwnPropertyDescriptor(G,d);Object.defineProperty(R,d,e.get?e:{enumerable:!0,get:function(){return G[d]}})}})}),Object.freeze(R)}function rt(R,O){return new Promise(function(G,d){let e;return Zt(R).then(function(t){try{return e=t,G(new Blob([O.slice(0,2),e,O.slice(2)],{type:"image/jpeg"}))}catch(c){return d(c)}},d)})}const Zt=R=>new Promise((O,G)=>{const d=new FileReader;d.addEventListener("load",({target:{result:e}})=>{const t=new DataView(e);let c=0;if(t.getUint16(c)!==65496)return G("not a valid JPEG");for(c+=2;;){const a=t.getUint16(c);if(a===65498)break;const g=t.getUint16(c+2);if(a===65505&&t.getUint32(c+4)===1165519206){const _=c+10;let r;switch(t.getUint16(_)){case 18761:r=!0;break;case 19789:r=!1;break;default:return G("TIFF header contains invalid endian")}if(t.getUint16(_+2,r)!==42)return G("TIFF header contains invalid version");const o=t.getUint32(_+4,r),n=_+o+2+12*t.getUint16(_+o,r);for(let s=_+o+2;s<n;s+=12)if(t.getUint16(s,r)==274){if(t.getUint16(s+2,r)!==3)return G("Orientation data type is invalid");if(t.getUint32(s+4,r)!==1)return G("Orientation data count is invalid");t.setUint16(s+8,1,r);break}return O(e.slice(c,c+2+g))}c+=2+g}return O(new Blob)}),d.readAsArrayBuffer(R)});var De={},Yt={get exports(){return De},set exports(R){De=R}};(function(R){var O,G,d={};Yt.exports=d,d.parse=function(e,t){for(var c=d.bin.readUshort,a=d.bin.readUint,g=0,_={},r=new Uint8Array(e),o=r.length-4;a(r,o)!=101010256;)o--;g=o,g+=4;var n=c(r,g+=4);c(r,g+=2);var s=a(r,g+=2),h=a(r,g+=4);g+=4,g=h;for(var b=0;b<n;b++){a(r,g),g+=4,g+=4,g+=4,a(r,g+=4),s=a(r,g+=4);var k=a(r,g+=4),m=c(r,g+=4),P=c(r,g+2),x=c(r,g+4);g+=6;var E=a(r,g+=8);g+=4,g+=m+P+x,d._readLocal(r,E,_,s,k,t)}return _},d._readLocal=function(e,t,c,a,g,_){var r=d.bin.readUshort,o=d.bin.readUint;o(e,t),r(e,t+=4),r(e,t+=2);var n=r(e,t+=2);o(e,t+=2),o(e,t+=4),t+=4;var s=r(e,t+=8),h=r(e,t+=2);t+=2;var b=d.bin.readUTF8(e,t,s);if(t+=s,t+=h,_)c[b]={size:g,csize:a};else{var k=new Uint8Array(e.buffer,t);if(n==0)c[b]=new Uint8Array(k.buffer.slice(t,t+a));else{if(n!=8)throw"unknown compression method: "+n;var m=new Uint8Array(g);d.inflateRaw(k,m),c[b]=m}}},d.inflateRaw=function(e,t){return d.F.inflate(e,t)},d.inflate=function(e,t){return e[0],e[1],d.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},d.deflate=function(e,t){t==null&&(t={level:6});var c=0,a=new Uint8Array(50+Math.floor(1.1*e.length));a[c]=120,a[c+1]=156,c+=2,c=d.F.deflateRaw(e,a,c,t.level);var g=d.adler(e,0,e.length);return a[c+0]=g>>>24&255,a[c+1]=g>>>16&255,a[c+2]=g>>>8&255,a[c+3]=g>>>0&255,new Uint8Array(a.buffer,0,c+4)},d.deflateRaw=function(e,t){t==null&&(t={level:6});var c=new Uint8Array(50+Math.floor(1.1*e.length)),a=d.F.deflateRaw(e,c,a,t.level);return new Uint8Array(c.buffer,0,a)},d.encode=function(e,t){t==null&&(t=!1);var c=0,a=d.bin.writeUint,g=d.bin.writeUshort,_={};for(var r in e){var o=!d._noNeed(r)&&!t,n=e[r],s=d.crc.crc(n,0,n.length);_[r]={cpr:o,usize:n.length,crc:s,file:o?d.deflateRaw(n):n}}for(var r in _)c+=_[r].file.length+30+46+2*d.bin.sizeUTF8(r);c+=22;var h=new Uint8Array(c),b=0,k=[];for(var r in _){var m=_[r];k.push(b),b=d._writeHeader(h,b,r,m,0)}var P=0,x=b;for(var r in _)m=_[r],k.push(b),b=d._writeHeader(h,b,r,m,1,k[P++]);var E=b-x;return a(h,b,101010256),b+=4,g(h,b+=4,P),g(h,b+=2,P),a(h,b+=2,E),a(h,b+=4,x),b+=4,b+=2,h.buffer},d._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},d._writeHeader=function(e,t,c,a,g,_){var r=d.bin.writeUint,o=d.bin.writeUshort,n=a.file;return r(e,t,g==0?67324752:33639248),t+=4,g==1&&(t+=2),o(e,t,20),o(e,t+=2,0),o(e,t+=2,a.cpr?8:0),r(e,t+=2,0),r(e,t+=4,a.crc),r(e,t+=4,n.length),r(e,t+=4,a.usize),o(e,t+=4,d.bin.sizeUTF8(c)),o(e,t+=2,0),t+=2,g==1&&(t+=2,t+=2,r(e,t+=6,_),t+=4),t+=d.bin.writeUTF8(e,t,c),g==0&&(e.set(n,t),t+=n.length),t},d.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var c=t,a=0;a<8;a++)1&c?c=3988292384^c>>>1:c>>>=1;e[t]=c}return e}(),update:function(e,t,c,a){for(var g=0;g<a;g++)e=d.crc.table[255&(e^t[c+g])]^e>>>8;return e},crc:function(e,t,c){return 4294967295^d.crc.update(4294967295,e,t,c)}},d.adler=function(e,t,c){for(var a=1,g=0,_=t,r=t+c;_<r;){for(var o=Math.min(_+5552,r);_<o;)g+=a+=e[_++];a%=65521,g%=65521}return g<<16|a},d.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,c){e[t]=255&c,e[t+1]=c>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,c){e[t]=255&c,e[t+1]=c>>8&255,e[t+2]=c>>16&255,e[t+3]=c>>24&255},readASCII:function(e,t,c){for(var a="",g=0;g<c;g++)a+=String.fromCharCode(e[t+g]);return a},writeASCII:function(e,t,c){for(var a=0;a<c.length;a++)e[t+a]=c.charCodeAt(a)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,c){for(var a,g="",_=0;_<c;_++)g+="%"+d.bin.pad(e[t+_].toString(16));try{a=decodeURIComponent(g)}catch{return d.bin.readASCII(e,t,c)}return a},writeUTF8:function(e,t,c){for(var a=c.length,g=0,_=0;_<a;_++){var r=c.charCodeAt(_);if(!(4294967168&r))e[t+g]=r,g++;else if(!(4294965248&r))e[t+g]=192|r>>6,e[t+g+1]=128|r>>0&63,g+=2;else if(!(4294901760&r))e[t+g]=224|r>>12,e[t+g+1]=128|r>>6&63,e[t+g+2]=128|r>>0&63,g+=3;else{if(4292870144&r)throw"e";e[t+g]=240|r>>18,e[t+g+1]=128|r>>12&63,e[t+g+2]=128|r>>6&63,e[t+g+3]=128|r>>0&63,g+=4}}return g},sizeUTF8:function(e){for(var t=e.length,c=0,a=0;a<t;a++){var g=e.charCodeAt(a);if(!(4294967168&g))c++;else if(!(4294965248&g))c+=2;else if(!(4294901760&g))c+=3;else{if(4292870144&g)throw"e";c+=4}}return c}},d.F={},d.F.deflateRaw=function(e,t,c,a){var g=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],_=d.F.U,r=d.F._goodIndex;d.F._hash;var o=d.F._putsE,n=0,s=c<<3,h=0,b=e.length;if(a==0){for(;n<b;)o(t,s,n+(v=Math.min(65535,b-n))==b?1:0),s=d.F._copyExact(e,n,v,t,s+8),n+=v;return s>>>3}var k=_.lits,m=_.strt,P=_.prev,x=0,E=0,U=0,p=0,T=0,l=0;for(b>2&&(m[l=d.F._hash(e,0)]=0),n=0;n<b;n++){if(T=l,n+1<b-2){l=d.F._hash(e,n+1);var f=n+1&32767;P[f]=m[l],m[l]=f}if(h<=n){(x>14e3||E>26697)&&b-n>100&&(h<n&&(k[x]=n-h,x+=2,h=n),s=d.F._writeBlock(n==b-1||h==b?1:0,k,x,p,e,U,n-U,t,s),x=E=p=0,U=n);var I=0;n<b-2&&(I=d.F._bestMatch(e,n,P,T,Math.min(g[2],b-n),g[3]));var v=I>>>16,A=65535&I;if(I!=0){A=65535&I;var w=r(v=I>>>16,_.of0);_.lhst[257+w]++;var y=r(A,_.df0);_.dhst[y]++,p+=_.exb[w]+_.dxb[y],k[x]=v<<23|n-h,k[x+1]=A<<16|w<<8|y,x+=2,h=n+v}else _.lhst[e[n]]++;E++}}for(U==n&&e.length!=0||(h<n&&(k[x]=n-h,x+=2,h=n),s=d.F._writeBlock(1,k,x,p,e,U,n-U,t,s),x=0,E=0,x=E=p=0,U=n);7&s;)s++;return s>>>3},d.F._bestMatch=function(e,t,c,a,g,_){var r=32767&t,o=c[r],n=r-o+32768&32767;if(o==r||a!=d.F._hash(e,t-n))return 0;for(var s=0,h=0,b=Math.min(32767,t);n<=b&&--_!=0&&o!=r;){if(s==0||e[t+s]==e[t+s-n]){var k=d.F._howLong(e,t,n);if(k>s){if(h=n,(s=k)>=g)break;n+2<k&&(k=n+2);for(var m=0,P=0;P<k-2;P++){var x=t-n+P+32768&32767,E=x-c[x]+32768&32767;E>m&&(m=E,o=x)}}}n+=(r=o)-(o=c[r])+32768&32767}return s<<16|h},d.F._howLong=function(e,t,c){if(e[t]!=e[t-c]||e[t+1]!=e[t+1-c]||e[t+2]!=e[t+2-c])return 0;var a=t,g=Math.min(e.length,t+258);for(t+=3;t<g&&e[t]==e[t-c];)t++;return t-a},d.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},d.saved=0,d.F._writeBlock=function(e,t,c,a,g,_,r,o,n){var s,h,b,k,m,P,x,E,U,p=d.F.U,T=d.F._putsF,l=d.F._putsE;p.lhst[256]++,h=(s=d.F.getTrees())[0],b=s[1],k=s[2],m=s[3],P=s[4],x=s[5],E=s[6],U=s[7];var f=32+(n+3&7?8-(n+3&7):0)+(r<<3),I=a+d.F.contSize(p.fltree,p.lhst)+d.F.contSize(p.fdtree,p.dhst),v=a+d.F.contSize(p.ltree,p.lhst)+d.F.contSize(p.dtree,p.dhst);v+=14+3*x+d.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var A=0;A<286;A++)p.lhst[A]=0;for(A=0;A<30;A++)p.dhst[A]=0;for(A=0;A<19;A++)p.ihst[A]=0;var w=f<I&&f<v?0:I<v?1:2;if(T(o,n,e),T(o,n+1,w),n+=3,w==0){for(;7&n;)n++;n=d.F._copyExact(g,_,r,o,n)}else{var y,C;if(w==1&&(y=p.fltree,C=p.fdtree),w==2){d.F.makeCodes(p.ltree,h),d.F.revCodes(p.ltree,h),d.F.makeCodes(p.dtree,b),d.F.revCodes(p.dtree,b),d.F.makeCodes(p.itree,k),d.F.revCodes(p.itree,k),y=p.ltree,C=p.dtree,l(o,n,m-257),l(o,n+=5,P-1),l(o,n+=5,x-4),n+=4;for(var u=0;u<x;u++)l(o,n+3*u,p.itree[1+(p.ordr[u]<<1)]);n+=3*x,n=d.F._codeTiny(E,p.itree,o,n),n=d.F._codeTiny(U,p.itree,o,n)}for(var i=_,L=0;L<c;L+=2){for(var N=t[L],M=N>>>23,B=i+(8388607&N);i<B;)n=d.F._writeLit(g[i++],y,o,n);if(M!=0){var D=t[L+1],z=D>>16,F=D>>8&255,S=255&D;l(o,n=d.F._writeLit(257+F,y,o,n),M-p.of0[F]),n+=p.exb[F],T(o,n=d.F._writeLit(S,C,o,n),z-p.df0[S]),n+=p.dxb[S],i+=M}}n=d.F._writeLit(256,y,o,n)}return n},d.F._copyExact=function(e,t,c,a,g){var _=g>>>3;return a[_]=c,a[_+1]=c>>>8,a[_+2]=255-a[_],a[_+3]=255-a[_+1],_+=4,a.set(new Uint8Array(e.buffer,t,c),_),g+(c+4<<3)},d.F.getTrees=function(){for(var e=d.F.U,t=d.F._hufTree(e.lhst,e.ltree,15),c=d.F._hufTree(e.dhst,e.dtree,15),a=[],g=d.F._lenCodes(e.ltree,a),_=[],r=d.F._lenCodes(e.dtree,_),o=0;o<a.length;o+=2)e.ihst[a[o]]++;for(o=0;o<_.length;o+=2)e.ihst[_[o]]++;for(var n=d.F._hufTree(e.ihst,e.itree,7),s=19;s>4&&e.itree[1+(e.ordr[s-1]<<1)]==0;)s--;return[t,c,n,g,r,s,a,_]},d.F.getSecond=function(e){for(var t=[],c=0;c<e.length;c+=2)t.push(e[c+1]);return t},d.F.nonZero=function(e){for(var t="",c=0;c<e.length;c+=2)e[c+1]!=0&&(t+=(c>>1)+",");return t},d.F.contSize=function(e,t){for(var c=0,a=0;a<t.length;a++)c+=t[a]*e[1+(a<<1)];return c},d.F._codeTiny=function(e,t,c,a){for(var g=0;g<e.length;g+=2){var _=e[g],r=e[g+1];a=d.F._writeLit(_,t,c,a);var o=_==16?2:_==17?3:7;_>15&&(d.F._putsE(c,a,r,o),a+=o)}return a},d.F._lenCodes=function(e,t){for(var c=e.length;c!=2&&e[c-1]==0;)c-=2;for(var a=0;a<c;a+=2){var g=e[a+1],_=a+3<c?e[a+3]:-1,r=a+5<c?e[a+5]:-1,o=a==0?-1:e[a-1];if(g==0&&_==g&&r==g){for(var n=a+5;n+2<c&&e[n+2]==g;)n+=2;(s=Math.min(n+1-a>>>1,138))<11?t.push(17,s-3):t.push(18,s-11),a+=2*s-2}else if(g==o&&_==g&&r==g){for(n=a+5;n+2<c&&e[n+2]==g;)n+=2;var s=Math.min(n+1-a>>>1,6);t.push(16,s-3),a+=2*s-2}else t.push(g,0)}return c>>>1},d.F._hufTree=function(e,t,c){var a=[],g=e.length,_=t.length,r=0;for(r=0;r<_;r+=2)t[r]=0,t[r+1]=0;for(r=0;r<g;r++)e[r]!=0&&a.push({lit:r,f:e[r]});var o=a.length,n=a.slice(0);if(o==0)return 0;if(o==1){var s=a[0].lit;return n=s==0?1:0,t[1+(s<<1)]=1,t[1+(n<<1)]=1,1}a.sort(function(E,U){return E.f-U.f});var h=a[0],b=a[1],k=0,m=1,P=2;for(a[0]={lit:-1,f:h.f+b.f,l:h,r:b,d:0};m!=o-1;)h=k!=m&&(P==o||a[k].f<a[P].f)?a[k++]:a[P++],b=k!=m&&(P==o||a[k].f<a[P].f)?a[k++]:a[P++],a[m++]={lit:-1,f:h.f+b.f,l:h,r:b};var x=d.F.setDepth(a[m-1],0);for(x>c&&(d.F.restrictDepth(n,c,x),x=c),r=0;r<o;r++)t[1+(n[r].lit<<1)]=n[r].d;return x},d.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(d.F.setDepth(e.l,t+1),d.F.setDepth(e.r,t+1))},d.F.restrictDepth=function(e,t,c){var a=0,g=1<<c-t,_=0;for(e.sort(function(o,n){return n.d==o.d?o.f-n.f:n.d-o.d}),a=0;a<e.length&&e[a].d>t;a++){var r=e[a].d;e[a].d=t,_+=g-(1<<c-r)}for(_>>>=c-t;_>0;)(r=e[a].d)<t?(e[a].d++,_-=1<<t-r-1):a++;for(;a>=0;a--)e[a].d==t&&_<0&&(e[a].d--,_++);_!=0&&console.log("debt left")},d.F._goodIndex=function(e,t){var c=0;return t[16|c]<=e&&(c|=16),t[8|c]<=e&&(c|=8),t[4|c]<=e&&(c|=4),t[2|c]<=e&&(c|=2),t[1|c]<=e&&(c|=1),c},d.F._writeLit=function(e,t,c,a){return d.F._putsF(c,a,t[e<<1]),a+t[1+(e<<1)]},d.F.inflate=function(e,t){var c=Uint8Array;if(e[0]==3&&e[1]==0)return t||new c(0);var a=d.F,g=a._bitsF,_=a._bitsE,r=a._decodeTiny,o=a.makeCodes,n=a.codes2map,s=a._get17,h=a.U,b=t==null;b&&(t=new c(e.length>>>2<<3));for(var k,m,P=0,x=0,E=0,U=0,p=0,T=0,l=0,f=0,I=0;P==0;)if(P=g(e,I,1),x=g(e,I+1,2),I+=3,x!=0){if(b&&(t=d.F._check(t,f+(1<<17))),x==1&&(k=h.flmap,m=h.fdmap,T=511,l=31),x==2){E=_(e,I,5)+257,U=_(e,I+5,5)+1,p=_(e,I+10,4)+4,I+=14;for(var v=0;v<38;v+=2)h.itree[v]=0,h.itree[v+1]=0;var A=1;for(v=0;v<p;v++){var w=_(e,I+3*v,3);h.itree[1+(h.ordr[v]<<1)]=w,w>A&&(A=w)}I+=3*p,o(h.itree,A),n(h.itree,A,h.imap),k=h.lmap,m=h.dmap,I=r(h.imap,(1<<A)-1,E+U,e,I,h.ttree);var y=a._copyOut(h.ttree,0,E,h.ltree);T=(1<<y)-1;var C=a._copyOut(h.ttree,E,U,h.dtree);l=(1<<C)-1,o(h.ltree,y),n(h.ltree,y,k),o(h.dtree,C),n(h.dtree,C,m)}for(;;){var u=k[s(e,I)&T];I+=15&u;var i=u>>>4;if(!(i>>>8))t[f++]=i;else{if(i==256)break;var L=f+i-254;if(i>264){var N=h.ldef[i-257];L=f+(N>>>3)+_(e,I,7&N),I+=7&N}var M=m[s(e,I)&l];I+=15&M;var B=M>>>4,D=h.ddef[B],z=(D>>>4)+g(e,I,15&D);for(I+=15&D,b&&(t=d.F._check(t,f+(1<<17)));f<L;)t[f]=t[f++-z],t[f]=t[f++-z],t[f]=t[f++-z],t[f]=t[f++-z];f=L}}}else{7&I&&(I+=8-(7&I));var F=4+(I>>>3),S=e[F-4]|e[F-3]<<8;b&&(t=d.F._check(t,f+S)),t.set(new c(e.buffer,e.byteOffset+F,S),f),I=F+S<<3,f+=S}return t.length==f?t:t.slice(0,f)},d.F._check=function(e,t){var c=e.length;if(t<=c)return e;var a=new Uint8Array(Math.max(c<<1,t));return a.set(e,0),a},d.F._decodeTiny=function(e,t,c,a,g,_){for(var r=d.F._bitsE,o=d.F._get17,n=0;n<c;){var s=e[o(a,g)&t];g+=15&s;var h=s>>>4;if(h<=15)_[n]=h,n++;else{var b=0,k=0;h==16?(k=3+r(a,g,2),g+=2,b=_[n-1]):h==17?(k=3+r(a,g,3),g+=3):h==18&&(k=11+r(a,g,7),g+=7);for(var m=n+k;n<m;)_[n]=b,n++}}return g},d.F._copyOut=function(e,t,c,a){for(var g=0,_=0,r=a.length>>>1;_<c;){var o=e[_+t];a[_<<1]=0,a[1+(_<<1)]=o,o>g&&(g=o),_++}for(;_<r;)a[_<<1]=0,a[1+(_<<1)]=0,_++;return g},d.F.makeCodes=function(e,t){for(var c,a,g,_,r=d.F.U,o=e.length,n=r.bl_count,s=0;s<=t;s++)n[s]=0;for(s=1;s<o;s+=2)n[e[s]]++;var h=r.next_code;for(c=0,n[0]=0,a=1;a<=t;a++)c=c+n[a-1]<<1,h[a]=c;for(g=0;g<o;g+=2)(_=e[g+1])!=0&&(e[g]=h[_],h[_]++)},d.F.codes2map=function(e,t,c){for(var a=e.length,g=d.F.U.rev15,_=0;_<a;_+=2)if(e[_+1]!=0)for(var r=_>>1,o=e[_+1],n=r<<4|o,s=t-o,h=e[_]<<s,b=h+(1<<s);h!=b;)c[g[h]>>>15-t]=n,h++},d.F.revCodes=function(e,t){for(var c=d.F.U.rev15,a=15-t,g=0;g<e.length;g+=2){var _=e[g]<<t-e[g+1];e[g]=c[_]>>>a}},d.F._putsE=function(e,t,c){c<<=7&t;var a=t>>>3;e[a]|=c,e[a+1]|=c>>>8},d.F._putsF=function(e,t,c){c<<=7&t;var a=t>>>3;e[a]|=c,e[a+1]|=c>>>8,e[a+2]|=c>>>16},d.F._bitsE=function(e,t,c){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<c)-1},d.F._bitsF=function(e,t,c){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<c)-1},d.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},d.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},d.F.U=(O=Uint16Array,G=Uint32Array,{next_code:new O(16),bl_count:new O(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new O(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new G(32),flmap:new O(512),fltree:[],fdmap:new O(32),fdtree:[],lmap:new O(32768),ltree:[],ttree:[],dmap:new O(32768),dtree:[],imap:new O(512),itree:[],rev15:new O(32768),lhst:new G(286),dhst:new G(30),ihst:new G(19),lits:new G(15e3),strt:new O(65536),prev:new O(32768)}),function(){for(var e=d.F.U,t=0;t<32768;t++){var c=t;c=(4278255360&(c=(4042322160&(c=(3435973836&(c=(2863311530&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,e.rev15[t]=(c>>>16|c<<16)>>>17}function a(g,_,r){for(;_--!=0;)g.push(0,r)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];a(e.fltree,144,8),a(e.fltree,112,9),a(e.fltree,24,7),a(e.fltree,8,8),d.F.makeCodes(e.fltree,9),d.F.codes2map(e.fltree,9,e.flmap),d.F.revCodes(e.fltree,9),a(e.fdtree,32,5),d.F.makeCodes(e.fdtree,5),d.F.codes2map(e.fdtree,5,e.fdmap),d.F.revCodes(e.fdtree,5),a(e.itree,19,0),a(e.ltree,286,0),a(e.dtree,30,0),a(e.ttree,320,0)}()})();var Jt=Xt({__proto__:null,default:De},[De]);const pe=function(){var R={nextZero(r,o){for(;r[o]!=0;)o++;return o},readUshort:(r,o)=>r[o]<<8|r[o+1],writeUshort(r,o,n){r[o]=n>>8&255,r[o+1]=255&n},readUint:(r,o)=>16777216*r[o]+(r[o+1]<<16|r[o+2]<<8|r[o+3]),writeUint(r,o,n){r[o]=n>>24&255,r[o+1]=n>>16&255,r[o+2]=n>>8&255,r[o+3]=255&n},readASCII(r,o,n){let s="";for(let h=0;h<n;h++)s+=String.fromCharCode(r[o+h]);return s},writeASCII(r,o,n){for(let s=0;s<n.length;s++)r[o+s]=n.charCodeAt(s)},readBytes(r,o,n){const s=[];for(let h=0;h<n;h++)s.push(r[o+h]);return s},pad:r=>r.length<2?`0${r}`:r,readUTF8(r,o,n){let s,h="";for(let b=0;b<n;b++)h+=`%${R.pad(r[o+b].toString(16))}`;try{s=decodeURIComponent(h)}catch{return R.readASCII(r,o,n)}return s}};function O(r,o,n,s){const h=o*n,b=t(s),k=Math.ceil(o*b/8),m=new Uint8Array(4*h),P=new Uint32Array(m.buffer),{ctype:x}=s,{depth:E}=s,U=R.readUshort;if(x==6){const N=h<<2;if(E==8)for(var p=0;p<N;p+=4)m[p]=r[p],m[p+1]=r[p+1],m[p+2]=r[p+2],m[p+3]=r[p+3];if(E==16)for(p=0;p<N;p++)m[p]=r[p<<1]}else if(x==2){const N=s.tabs.tRNS;if(N==null){if(E==8)for(p=0;p<h;p++){var T=3*p;P[p]=255<<24|r[T+2]<<16|r[T+1]<<8|r[T]}if(E==16)for(p=0;p<h;p++)T=6*p,P[p]=255<<24|r[T+4]<<16|r[T+2]<<8|r[T]}else{var l=N[0];const M=N[1],B=N[2];if(E==8)for(p=0;p<h;p++){var f=p<<2;T=3*p,P[p]=255<<24|r[T+2]<<16|r[T+1]<<8|r[T],r[T]==l&&r[T+1]==M&&r[T+2]==B&&(m[f+3]=0)}if(E==16)for(p=0;p<h;p++)f=p<<2,T=6*p,P[p]=255<<24|r[T+4]<<16|r[T+2]<<8|r[T],U(r,T)==l&&U(r,T+2)==M&&U(r,T+4)==B&&(m[f+3]=0)}}else if(x==3){const N=s.tabs.PLTE,M=s.tabs.tRNS,B=M?M.length:0;if(E==1)for(var I=0;I<n;I++){var v=I*k,A=I*o;for(p=0;p<o;p++){f=A+p<<2;var w=3*(y=r[v+(p>>3)]>>7-((7&p)<<0)&1);m[f]=N[w],m[f+1]=N[w+1],m[f+2]=N[w+2],m[f+3]=y<B?M[y]:255}}if(E==2)for(I=0;I<n;I++)for(v=I*k,A=I*o,p=0;p<o;p++)f=A+p<<2,w=3*(y=r[v+(p>>2)]>>6-((3&p)<<1)&3),m[f]=N[w],m[f+1]=N[w+1],m[f+2]=N[w+2],m[f+3]=y<B?M[y]:255;if(E==4)for(I=0;I<n;I++)for(v=I*k,A=I*o,p=0;p<o;p++)f=A+p<<2,w=3*(y=r[v+(p>>1)]>>4-((1&p)<<2)&15),m[f]=N[w],m[f+1]=N[w+1],m[f+2]=N[w+2],m[f+3]=y<B?M[y]:255;if(E==8)for(p=0;p<h;p++){var y;f=p<<2,w=3*(y=r[p]),m[f]=N[w],m[f+1]=N[w+1],m[f+2]=N[w+2],m[f+3]=y<B?M[y]:255}}else if(x==4){if(E==8)for(p=0;p<h;p++){f=p<<2;var C=r[u=p<<1];m[f]=C,m[f+1]=C,m[f+2]=C,m[f+3]=r[u+1]}if(E==16)for(p=0;p<h;p++){var u;f=p<<2,C=r[u=p<<2],m[f]=C,m[f+1]=C,m[f+2]=C,m[f+3]=r[u+2]}}else if(x==0)for(l=s.tabs.tRNS?s.tabs.tRNS:-1,I=0;I<n;I++){const N=I*k,M=I*o;if(E==1)for(var i=0;i<o;i++){var L=(C=255*(r[N+(i>>>3)]>>>7-(7&i)&1))==255*l?0:255;P[M+i]=L<<24|C<<16|C<<8|C}else if(E==2)for(i=0;i<o;i++)L=(C=85*(r[N+(i>>>2)]>>>6-((3&i)<<1)&3))==85*l?0:255,P[M+i]=L<<24|C<<16|C<<8|C;else if(E==4)for(i=0;i<o;i++)L=(C=17*(r[N+(i>>>1)]>>>4-((1&i)<<2)&15))==17*l?0:255,P[M+i]=L<<24|C<<16|C<<8|C;else if(E==8)for(i=0;i<o;i++)L=(C=r[N+i])==l?0:255,P[M+i]=L<<24|C<<16|C<<8|C;else if(E==16)for(i=0;i<o;i++)C=r[N+(i<<1)],L=U(r,N+(i<<1))==l?0:255,P[M+i]=L<<24|C<<16|C<<8|C}return m}function G(r,o,n,s){const h=t(r),b=Math.ceil(n*h/8),k=new Uint8Array((b+1+r.interlace)*s);return o=r.tabs.CgBI?e(o,k):d(o,k),r.interlace==0?o=c(o,r,0,n,s):r.interlace==1&&(o=function(P,x){const E=x.width,U=x.height,p=t(x),T=p>>3,l=Math.ceil(E*p/8),f=new Uint8Array(U*l);let I=0;const v=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],y=[8,8,4,4,2,2,1];let C=0;for(;C<7;){const i=w[C],L=y[C];let N=0,M=0,B=v[C];for(;B<U;)B+=i,M++;let D=A[C];for(;D<E;)D+=L,N++;const z=Math.ceil(N*p/8);c(P,x,I,N,M);let F=0,S=v[C];for(;S<U;){let H=A[C],j=I+F*z<<3;for(;H<E;){var u;if(p==1&&(u=(u=P[j>>3])>>7-(7&j)&1,f[S*l+(H>>3)]|=u<<7-((7&H)<<0)),p==2&&(u=(u=P[j>>3])>>6-(7&j)&3,f[S*l+(H>>2)]|=u<<6-((3&H)<<1)),p==4&&(u=(u=P[j>>3])>>4-(7&j)&15,f[S*l+(H>>1)]|=u<<4-((1&H)<<2)),p>=8){const $=S*l+H*T;for(let V=0;V<T;V++)f[$+V]=P[(j>>3)+V]}j+=p,H+=L}F++,S+=i}N*M!=0&&(I+=M*(1+z)),C+=1}return f}(o,r)),o}function d(r,o){return e(new Uint8Array(r.buffer,2,r.length-6),o)}var e=function(){const r={H:{}};return r.H.N=function(o,n){const s=Uint8Array;let h,b,k=0,m=0,P=0,x=0,E=0,U=0,p=0,T=0,l=0;if(o[0]==3&&o[1]==0)return n||new s(0);const f=r.H,I=f.b,v=f.e,A=f.R,w=f.n,y=f.A,C=f.Z,u=f.m,i=n==null;for(i&&(n=new s(o.length>>>2<<5));k==0;)if(k=I(o,l,1),m=I(o,l+1,2),l+=3,m!=0){if(i&&(n=r.H.W(n,T+(1<<17))),m==1&&(h=u.J,b=u.h,U=511,p=31),m==2){P=v(o,l,5)+257,x=v(o,l+5,5)+1,E=v(o,l+10,4)+4,l+=14;let N=1;for(var L=0;L<38;L+=2)u.Q[L]=0,u.Q[L+1]=0;for(L=0;L<E;L++){const D=v(o,l+3*L,3);u.Q[1+(u.X[L]<<1)]=D,D>N&&(N=D)}l+=3*E,w(u.Q,N),y(u.Q,N,u.u),h=u.w,b=u.d,l=A(u.u,(1<<N)-1,P+x,o,l,u.v);const M=f.V(u.v,0,P,u.C);U=(1<<M)-1;const B=f.V(u.v,P,x,u.D);p=(1<<B)-1,w(u.C,M),y(u.C,M,h),w(u.D,B),y(u.D,B,b)}for(;;){const N=h[C(o,l)&U];l+=15&N;const M=N>>>4;if(!(M>>>8))n[T++]=M;else{if(M==256)break;{let B=T+M-254;if(M>264){const H=u.q[M-257];B=T+(H>>>3)+v(o,l,7&H),l+=7&H}const D=b[C(o,l)&p];l+=15&D;const z=D>>>4,F=u.c[z],S=(F>>>4)+I(o,l,15&F);for(l+=15&F;T<B;)n[T]=n[T++-S],n[T]=n[T++-S],n[T]=n[T++-S],n[T]=n[T++-S];T=B}}}}else{7&l&&(l+=8-(7&l));const N=4+(l>>>3),M=o[N-4]|o[N-3]<<8;i&&(n=r.H.W(n,T+M)),n.set(new s(o.buffer,o.byteOffset+N,M),T),l=N+M<<3,T+=M}return n.length==T?n:n.slice(0,T)},r.H.W=function(o,n){const s=o.length;if(n<=s)return o;const h=new Uint8Array(s<<1);return h.set(o,0),h},r.H.R=function(o,n,s,h,b,k){const m=r.H.e,P=r.H.Z;let x=0;for(;x<s;){const E=o[P(h,b)&n];b+=15&E;const U=E>>>4;if(U<=15)k[x]=U,x++;else{let p=0,T=0;U==16?(T=3+m(h,b,2),b+=2,p=k[x-1]):U==17?(T=3+m(h,b,3),b+=3):U==18&&(T=11+m(h,b,7),b+=7);const l=x+T;for(;x<l;)k[x]=p,x++}}return b},r.H.V=function(o,n,s,h){let b=0,k=0;const m=h.length>>>1;for(;k<s;){const P=o[k+n];h[k<<1]=0,h[1+(k<<1)]=P,P>b&&(b=P),k++}for(;k<m;)h[k<<1]=0,h[1+(k<<1)]=0,k++;return b},r.H.n=function(o,n){const s=r.H.m,h=o.length;let b,k,m,P;const x=s.j;for(var E=0;E<=n;E++)x[E]=0;for(E=1;E<h;E+=2)x[o[E]]++;const U=s.K;for(b=0,x[0]=0,k=1;k<=n;k++)b=b+x[k-1]<<1,U[k]=b;for(m=0;m<h;m+=2)P=o[m+1],P!=0&&(o[m]=U[P],U[P]++)},r.H.A=function(o,n,s){const h=o.length,b=r.H.m.r;for(let k=0;k<h;k+=2)if(o[k+1]!=0){const m=k>>1,P=o[k+1],x=m<<4|P,E=n-P;let U=o[k]<<E;const p=U+(1<<E);for(;U!=p;)s[b[U]>>>15-n]=x,U++}},r.H.l=function(o,n){const s=r.H.m.r,h=15-n;for(let b=0;b<o.length;b+=2){const k=o[b]<<n-o[b+1];o[b]=s[k]>>>h}},r.H.M=function(o,n,s){s<<=7&n;const h=n>>>3;o[h]|=s,o[h+1]|=s>>>8},r.H.I=function(o,n,s){s<<=7&n;const h=n>>>3;o[h]|=s,o[h+1]|=s>>>8,o[h+2]|=s>>>16},r.H.e=function(o,n,s){return(o[n>>>3]|o[1+(n>>>3)]<<8)>>>(7&n)&(1<<s)-1},r.H.b=function(o,n,s){return(o[n>>>3]|o[1+(n>>>3)]<<8|o[2+(n>>>3)]<<16)>>>(7&n)&(1<<s)-1},r.H.Z=function(o,n){return(o[n>>>3]|o[1+(n>>>3)]<<8|o[2+(n>>>3)]<<16)>>>(7&n)},r.H.i=function(o,n){return(o[n>>>3]|o[1+(n>>>3)]<<8|o[2+(n>>>3)]<<16|o[3+(n>>>3)]<<24)>>>(7&n)},r.H.m=function(){const o=Uint16Array,n=Uint32Array;return{K:new o(16),j:new o(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new o(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new o(512),_:[],h:new o(32),$:[],w:new o(32768),C:[],v:[],d:new o(32768),D:[],u:new o(512),Q:[],r:new o(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new o(65536),g:new o(32768)}}(),function(){const o=r.H.m;for(var n=0;n<32768;n++){let h=n;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,o.r[n]=(h>>>16|h<<16)>>>17}function s(h,b,k){for(;b--!=0;)h.push(0,k)}for(n=0;n<32;n++)o.q[n]=o.S[n]<<3|o.T[n],o.c[n]=o.p[n]<<4|o.z[n];s(o._,144,8),s(o._,112,9),s(o._,24,7),s(o._,8,8),r.H.n(o._,9),r.H.A(o._,9,o.J),r.H.l(o._,9),s(o.$,32,5),r.H.n(o.$,5),r.H.A(o.$,5,o.h),r.H.l(o.$,5),s(o.Q,19,0),s(o.C,286,0),s(o.D,30,0),s(o.v,320,0)}(),r.H.N}();function t(r){return[1,null,3,1,2,null,4][r.ctype]*r.depth}function c(r,o,n,s,h){let b=t(o);const k=Math.ceil(s*b/8);let m,P;b=Math.ceil(b/8);let x=r[n],E=0;if(x>1&&(r[n]=[0,0,1][x-2]),x==3)for(E=b;E<k;E++)r[E+1]=r[E+1]+(r[E+1-b]>>>1)&255;for(let U=0;U<h;U++)if(m=n+U*k,P=m+U+1,x=r[P-1],E=0,x==0)for(;E<k;E++)r[m+E]=r[P+E];else if(x==1){for(;E<b;E++)r[m+E]=r[P+E];for(;E<k;E++)r[m+E]=r[P+E]+r[m+E-b]}else if(x==2)for(;E<k;E++)r[m+E]=r[P+E]+r[m+E-k];else if(x==3){for(;E<b;E++)r[m+E]=r[P+E]+(r[m+E-k]>>>1);for(;E<k;E++)r[m+E]=r[P+E]+(r[m+E-k]+r[m+E-b]>>>1)}else{for(;E<b;E++)r[m+E]=r[P+E]+a(0,r[m+E-k],0);for(;E<k;E++)r[m+E]=r[P+E]+a(r[m+E-b],r[m+E-k],r[m+E-b-k])}return r}function a(r,o,n){const s=r+o-n,h=s-r,b=s-o,k=s-n;return h*h<=b*b&&h*h<=k*k?r:b*b<=k*k?o:n}function g(r,o,n){n.width=R.readUint(r,o),o+=4,n.height=R.readUint(r,o),o+=4,n.depth=r[o],o++,n.ctype=r[o],o++,n.compress=r[o],o++,n.filter=r[o],o++,n.interlace=r[o],o++}function _(r,o,n,s,h,b,k,m,P){const x=Math.min(o,h),E=Math.min(n,b);let U=0,p=0;for(let C=0;C<E;C++)for(let u=0;u<x;u++)if(k>=0&&m>=0?(U=C*o+u<<2,p=(m+C)*h+k+u<<2):(U=(-m+C)*o-k+u<<2,p=C*h+u<<2),P==0)s[p]=r[U],s[p+1]=r[U+1],s[p+2]=r[U+2],s[p+3]=r[U+3];else if(P==1){var T=r[U+3]*.00392156862745098,l=r[U]*T,f=r[U+1]*T,I=r[U+2]*T,v=s[p+3]*(1/255),A=s[p]*v,w=s[p+1]*v,y=s[p+2]*v;const i=1-T,L=T+v*i,N=L==0?0:1/L;s[p+3]=255*L,s[p+0]=(l+A*i)*N,s[p+1]=(f+w*i)*N,s[p+2]=(I+y*i)*N}else if(P==2)T=r[U+3],l=r[U],f=r[U+1],I=r[U+2],v=s[p+3],A=s[p],w=s[p+1],y=s[p+2],T==v&&l==A&&f==w&&I==y?(s[p]=0,s[p+1]=0,s[p+2]=0,s[p+3]=0):(s[p]=l,s[p+1]=f,s[p+2]=I,s[p+3]=T);else if(P==3){if(T=r[U+3],l=r[U],f=r[U+1],I=r[U+2],v=s[p+3],A=s[p],w=s[p+1],y=s[p+2],T==v&&l==A&&f==w&&I==y)continue;if(T<220&&v>20)return!1}return!0}return{decode:function(o){const n=new Uint8Array(o);let s=8;const h=R,b=h.readUshort,k=h.readUint,m={tabs:{},frames:[]},P=new Uint8Array(n.length);let x,E=0,U=0;const p=[137,80,78,71,13,10,26,10];for(var T=0;T<8;T++)if(n[T]!=p[T])throw"The input is not a PNG file!";for(;s<n.length;){const C=h.readUint(n,s);s+=4;const u=h.readASCII(n,s,4);if(s+=4,u=="IHDR")g(n,s,m);else if(u=="iCCP"){for(var l=s;n[l]!=0;)l++;h.readASCII(n,s,l-s),n[l+1];const i=n.slice(l+2,s+C);let L=null;try{L=d(i)}catch{L=e(i)}m.tabs[u]=L}else if(u=="CgBI")m.tabs[u]=n.slice(s,s+4);else if(u=="IDAT"){for(T=0;T<C;T++)P[E+T]=n[s+T];E+=C}else if(u=="acTL")m.tabs[u]={num_frames:k(n,s),num_plays:k(n,s+4)},x=new Uint8Array(n.length);else if(u=="fcTL"){U!=0&&((y=m.frames[m.frames.length-1]).data=G(m,x.slice(0,U),y.rect.width,y.rect.height),U=0);const i={x:k(n,s+12),y:k(n,s+16),width:k(n,s+4),height:k(n,s+8)};let L=b(n,s+22);L=b(n,s+20)/(L==0?100:L);const N={rect:i,delay:Math.round(1e3*L),dispose:n[s+24],blend:n[s+25]};m.frames.push(N)}else if(u=="fdAT"){for(T=0;T<C-4;T++)x[U+T]=n[s+T+4];U+=C-4}else if(u=="pHYs")m.tabs[u]=[h.readUint(n,s),h.readUint(n,s+4),n[s+8]];else if(u=="cHRM")for(m.tabs[u]=[],T=0;T<8;T++)m.tabs[u].push(h.readUint(n,s+4*T));else if(u=="tEXt"||u=="zTXt"){m.tabs[u]==null&&(m.tabs[u]={});var f=h.nextZero(n,s),I=h.readASCII(n,s,f-s),v=s+C-f-1;if(u=="tEXt")w=h.readASCII(n,f+1,v);else{var A=d(n.slice(f+2,f+2+v));w=h.readUTF8(A,0,A.length)}m.tabs[u][I]=w}else if(u=="iTXt"){m.tabs[u]==null&&(m.tabs[u]={}),f=0,l=s,f=h.nextZero(n,l),I=h.readASCII(n,l,f-l);const i=n[l=f+1];var w;n[l+1],l+=2,f=h.nextZero(n,l),h.readASCII(n,l,f-l),l=f+1,f=h.nextZero(n,l),h.readUTF8(n,l,f-l),v=C-((l=f+1)-s),i==0?w=h.readUTF8(n,l,v):(A=d(n.slice(l,l+v)),w=h.readUTF8(A,0,A.length)),m.tabs[u][I]=w}else if(u=="PLTE")m.tabs[u]=h.readBytes(n,s,C);else if(u=="hIST"){const i=m.tabs.PLTE.length/3;for(m.tabs[u]=[],T=0;T<i;T++)m.tabs[u].push(b(n,s+2*T))}else if(u=="tRNS")m.ctype==3?m.tabs[u]=h.readBytes(n,s,C):m.ctype==0?m.tabs[u]=b(n,s):m.ctype==2&&(m.tabs[u]=[b(n,s),b(n,s+2),b(n,s+4)]);else if(u=="gAMA")m.tabs[u]=h.readUint(n,s)/1e5;else if(u=="sRGB")m.tabs[u]=n[s];else if(u=="bKGD")m.ctype==0||m.ctype==4?m.tabs[u]=[b(n,s)]:m.ctype==2||m.ctype==6?m.tabs[u]=[b(n,s),b(n,s+2),b(n,s+4)]:m.ctype==3&&(m.tabs[u]=n[s]);else if(u=="IEND")break;s+=C,h.readUint(n,s),s+=4}var y;return U!=0&&((y=m.frames[m.frames.length-1]).data=G(m,x.slice(0,U),y.rect.width,y.rect.height)),m.data=G(m,P,m.width,m.height),delete m.compress,delete m.interlace,delete m.filter,m},toRGBA8:function(o){const n=o.width,s=o.height;if(o.tabs.acTL==null)return[O(o.data,n,s,o).buffer];const h=[];o.frames[0].data==null&&(o.frames[0].data=o.data);const b=n*s*4,k=new Uint8Array(b),m=new Uint8Array(b),P=new Uint8Array(b);for(let E=0;E<o.frames.length;E++){const U=o.frames[E],p=U.rect.x,T=U.rect.y,l=U.rect.width,f=U.rect.height,I=O(U.data,l,f,o);if(E!=0)for(var x=0;x<b;x++)P[x]=k[x];if(U.blend==0?_(I,l,f,k,n,s,p,T,0):U.blend==1&&_(I,l,f,k,n,s,p,T,1),h.push(k.buffer.slice(0)),U.dispose!=0){if(U.dispose==1)_(m,l,f,k,n,s,p,T,0);else if(U.dispose==2)for(x=0;x<b;x++)k[x]=P[x]}}return h},_paeth:a,_copyTile:_,_bin:R}}();(function(){const{_copyTile:R}=pe,{_bin:O}=pe,G=pe._paeth;var d={table:function(){const l=new Uint32Array(256);for(let f=0;f<256;f++){let I=f;for(let v=0;v<8;v++)1&I?I=3988292384^I>>>1:I>>>=1;l[f]=I}return l}(),update(l,f,I,v){for(let A=0;A<v;A++)l=d.table[255&(l^f[I+A])]^l>>>8;return l},crc:(l,f,I)=>4294967295^d.update(4294967295,l,f,I)};function e(l,f,I,v){f[I]+=l[0]*v>>4,f[I+1]+=l[1]*v>>4,f[I+2]+=l[2]*v>>4,f[I+3]+=l[3]*v>>4}function t(l){return Math.max(0,Math.min(255,l))}function c(l,f){const I=l[0]-f[0],v=l[1]-f[1],A=l[2]-f[2],w=l[3]-f[3];return I*I+v*v+A*A+w*w}function a(l,f,I,v,A,w,y){y==null&&(y=1);const C=v.length,u=[];for(var i=0;i<C;i++){const S=v[i];u.push([S>>>0&255,S>>>8&255,S>>>16&255,S>>>24&255])}for(i=0;i<C;i++){let S=4294967295;for(var L=0,N=0;N<C;N++){var M=c(u[i],u[N]);N!=i&&M<S&&(S=M,L=N)}}const B=new Uint32Array(A.buffer),D=new Int16Array(f*I*4),z=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(i=0;i<z.length;i++)z[i]=255*((z[i]+.5)/16-.5);for(let S=0;S<I;S++)for(let H=0;H<f;H++){var F;i=4*(S*f+H),y!=2?F=[t(l[i]+D[i]),t(l[i+1]+D[i+1]),t(l[i+2]+D[i+2]),t(l[i+3]+D[i+3])]:(M=z[4*(3&S)+(3&H)],F=[t(l[i]+M),t(l[i+1]+M),t(l[i+2]+M),t(l[i+3]+M)]),L=0;let j=16777215;for(N=0;N<C;N++){const Q=c(F,u[N]);Q<j&&(j=Q,L=N)}const $=u[L],V=[F[0]-$[0],F[1]-$[1],F[2]-$[2],F[3]-$[3]];y==1&&(H!=f-1&&e(V,D,i+4,7),S!=I-1&&(H!=0&&e(V,D,i+4*f-4,3),e(V,D,i+4*f,5),H!=f-1&&e(V,D,i+4*f+4,1))),w[i>>2]=L,B[i>>2]=v[L]}}function g(l,f,I,v,A){A==null&&(A={});const{crc:w}=d,y=O.writeUint,C=O.writeUshort,u=O.writeASCII;let i=8;const L=l.frames.length>1;let N,M=!1,B=33+(L?20:0);if(A.sRGB!=null&&(B+=13),A.pHYs!=null&&(B+=21),A.iCCP!=null&&(N=pako.deflate(A.iCCP),B+=21+N.length+4),l.ctype==3){for(var D=l.plte.length,z=0;z<D;z++)l.plte[z]>>>24!=255&&(M=!0);B+=8+3*D+4+(M?8+1*D+4:0)}for(var F=0;F<l.frames.length;F++)L&&(B+=38),B+=($=l.frames[F]).cimg.length+12,F!=0&&(B+=4);B+=12;const S=new Uint8Array(B),H=[137,80,78,71,13,10,26,10];for(z=0;z<8;z++)S[z]=H[z];if(y(S,i,13),i+=4,u(S,i,"IHDR"),i+=4,y(S,i,f),i+=4,y(S,i,I),i+=4,S[i]=l.depth,i++,S[i]=l.ctype,i++,S[i]=0,i++,S[i]=0,i++,S[i]=0,i++,y(S,i,w(S,i-17,17)),i+=4,A.sRGB!=null&&(y(S,i,1),i+=4,u(S,i,"sRGB"),i+=4,S[i]=A.sRGB,i++,y(S,i,w(S,i-5,5)),i+=4),A.iCCP!=null){const V=13+N.length;y(S,i,V),i+=4,u(S,i,"iCCP"),i+=4,u(S,i,"ICC profile"),i+=11,i+=2,S.set(N,i),i+=N.length,y(S,i,w(S,i-(V+4),V+4)),i+=4}if(A.pHYs!=null&&(y(S,i,9),i+=4,u(S,i,"pHYs"),i+=4,y(S,i,A.pHYs[0]),i+=4,y(S,i,A.pHYs[1]),i+=4,S[i]=A.pHYs[2],i++,y(S,i,w(S,i-13,13)),i+=4),L&&(y(S,i,8),i+=4,u(S,i,"acTL"),i+=4,y(S,i,l.frames.length),i+=4,y(S,i,A.loop!=null?A.loop:0),i+=4,y(S,i,w(S,i-12,12)),i+=4),l.ctype==3){for(y(S,i,3*(D=l.plte.length)),i+=4,u(S,i,"PLTE"),i+=4,z=0;z<D;z++){const V=3*z,Q=l.plte[z],Z=255&Q,ee=Q>>>8&255,we=Q>>>16&255;S[i+V+0]=Z,S[i+V+1]=ee,S[i+V+2]=we}if(i+=3*D,y(S,i,w(S,i-3*D-4,3*D+4)),i+=4,M){for(y(S,i,D),i+=4,u(S,i,"tRNS"),i+=4,z=0;z<D;z++)S[i+z]=l.plte[z]>>>24&255;i+=D,y(S,i,w(S,i-D-4,D+4)),i+=4}}let j=0;for(F=0;F<l.frames.length;F++){var $=l.frames[F];L&&(y(S,i,26),i+=4,u(S,i,"fcTL"),i+=4,y(S,i,j++),i+=4,y(S,i,$.rect.width),i+=4,y(S,i,$.rect.height),i+=4,y(S,i,$.rect.x),i+=4,y(S,i,$.rect.y),i+=4,C(S,i,v[F]),i+=2,C(S,i,1e3),i+=2,S[i]=$.dispose,i++,S[i]=$.blend,i++,y(S,i,w(S,i-30,30)),i+=4);const V=$.cimg;y(S,i,(D=V.length)+(F==0?0:4)),i+=4;const Q=i;u(S,i,F==0?"IDAT":"fdAT"),i+=4,F!=0&&(y(S,i,j++),i+=4),S.set(V,i),i+=D,y(S,i,w(S,Q,i-Q)),i+=4}return y(S,i,0),i+=4,u(S,i,"IEND"),i+=4,y(S,i,w(S,i-4,4)),i+=4,S.buffer}function _(l,f,I){for(let v=0;v<l.frames.length;v++){const A=l.frames[v];A.rect.width;const w=A.rect.height,y=new Uint8Array(w*A.bpl+w);A.cimg=s(A.img,w,A.bpp,A.bpl,y,f,I)}}function r(l,f,I,v,A){const w=A[0],y=A[1],C=A[2],u=A[3],i=A[4],L=A[5];let N=6,M=8,B=255;for(var D=0;D<l.length;D++){const ne=new Uint8Array(l[D]);for(var z=ne.length,F=0;F<z;F+=4)B&=ne[F+3]}const S=B!=255,H=function(q,K,te,ie,Y,fe){const J=[];for(var W=0;W<q.length;W++){const ae=new Uint8Array(q[W]),de=new Uint32Array(ae.buffer);var ce;let ue=0,ye=0,me=K,Ee=te,$e=ie?1:0;if(W!=0){const ht=fe||ie||W==1||J[W-2].dispose!=0?1:2;let Qe=0,Ze=1e9;for(let Ue=0;Ue<ht;Ue++){var Ie=new Uint8Array(q[W-1-Ue]);const mt=new Uint32Array(q[W-1-Ue]);let Ae=K,_e=te,Oe=-1,Pe=-1;for(let Ce=0;Ce<te;Ce++)for(let ke=0;ke<K;ke++)de[re=Ce*K+ke]!=mt[re]&&(ke<Ae&&(Ae=ke),ke>Oe&&(Oe=ke),Ce<_e&&(_e=Ce),Ce>Pe&&(Pe=Ce));Oe==-1&&(Ae=_e=Oe=Pe=0),Y&&((1&Ae)==1&&Ae--,(1&_e)==1&&_e--);const Ye=(Oe-Ae+1)*(Pe-_e+1);Ye<Ze&&(Ze=Ye,Qe=Ue,ue=Ae,ye=_e,me=Oe-Ae+1,Ee=Pe-_e+1)}Ie=new Uint8Array(q[W-1-Qe]),Qe==1&&(J[W-1].dispose=2),ce=new Uint8Array(me*Ee*4),R(Ie,K,te,ce,me,Ee,-ue,-ye,0),$e=R(ae,K,te,ce,me,Ee,-ue,-ye,3)?1:0,$e==1?n(ae,K,te,ce,{x:ue,y:ye,width:me,height:Ee}):R(ae,K,te,ce,me,Ee,-ue,-ye,0)}else ce=ae.slice(0);J.push({rect:{x:ue,y:ye,width:me,height:Ee},img:ce,blend:$e,dispose:0})}if(ie)for(W=0;W<J.length;W++){if((Ne=J[W]).blend==1)continue;const ae=Ne.rect,de=J[W-1].rect,ue=Math.min(ae.x,de.x),ye=Math.min(ae.y,de.y),me={x:ue,y:ye,width:Math.max(ae.x+ae.width,de.x+de.width)-ue,height:Math.max(ae.y+ae.height,de.y+de.height)-ye};J[W-1].dispose=1,W-1!=0&&o(q,K,te,J,W-1,me,Y),o(q,K,te,J,W,me,Y)}let Me=0;if(q.length!=1)for(var re=0;re<J.length;re++){var Ne;Me+=(Ne=J[re]).rect.width*Ne.rect.height}return J}(l,f,I,w,y,C),j={},$=[],V=[];if(v!=0){const ne=[];for(F=0;F<H.length;F++)ne.push(H[F].img.buffer);const q=function(Y){let fe=0;for(var J=0;J<Y.length;J++)fe+=Y[J].byteLength;const W=new Uint8Array(fe);let ce=0;for(J=0;J<Y.length;J++){const Ie=new Uint8Array(Y[J]),Me=Ie.length;for(let re=0;re<Me;re+=4){let Ne=Ie[re],ae=Ie[re+1],de=Ie[re+2];const ue=Ie[re+3];ue==0&&(Ne=ae=de=0),W[ce+re]=Ne,W[ce+re+1]=ae,W[ce+re+2]=de,W[ce+re+3]=ue}ce+=Me}return W.buffer}(ne),K=b(q,v);for(F=0;F<K.plte.length;F++)$.push(K.plte[F].est.rgba);let te=0;for(F=0;F<H.length;F++){const ie=(Z=H[F]).img.length;var Q=new Uint8Array(K.inds.buffer,te>>2,ie>>2);V.push(Q);const Y=new Uint8Array(K.abuf,te,ie);L&&a(Z.img,Z.rect.width,Z.rect.height,$,Y,Q),Z.img.set(Y),te+=ie}}else for(D=0;D<H.length;D++){var Z=H[D];const ne=new Uint32Array(Z.img.buffer);var ee=Z.rect.width;for(z=ne.length,Q=new Uint8Array(z),V.push(Q),F=0;F<z;F++){const q=ne[F];if(F!=0&&q==ne[F-1])Q[F]=Q[F-1];else if(F>ee&&q==ne[F-ee])Q[F]=Q[F-ee];else{let K=j[q];if(K==null&&(j[q]=K=$.length,$.push(q),$.length>=300))break;Q[F]=K}}}const we=$.length;for(we<=256&&i==0&&(M=we<=2?1:we<=4?2:we<=16?4:8,M=Math.max(M,u)),D=0;D<H.length;D++){(Z=H[D]).rect.x,Z.rect.y,ee=Z.rect.width;const ne=Z.rect.height;let q=Z.img;new Uint32Array(q.buffer);let K=4*ee,te=4;if(we<=256&&i==0){K=Math.ceil(M*ee/8);var he=new Uint8Array(K*ne);const ie=V[D];for(let Y=0;Y<ne;Y++){F=Y*K;const fe=Y*ee;if(M==8)for(var X=0;X<ee;X++)he[F+X]=ie[fe+X];else if(M==4)for(X=0;X<ee;X++)he[F+(X>>1)]|=ie[fe+X]<<4-4*(1&X);else if(M==2)for(X=0;X<ee;X++)he[F+(X>>2)]|=ie[fe+X]<<6-2*(3&X);else if(M==1)for(X=0;X<ee;X++)he[F+(X>>3)]|=ie[fe+X]<<7-1*(7&X)}q=he,N=3,te=1}else if(S==0&&H.length==1){he=new Uint8Array(ee*ne*3);const ie=ee*ne;for(F=0;F<ie;F++){const Y=3*F,fe=4*F;he[Y]=q[fe],he[Y+1]=q[fe+1],he[Y+2]=q[fe+2]}q=he,N=2,te=3,K=3*ee}Z.img=q,Z.bpl=K,Z.bpp=te}return{ctype:N,depth:M,plte:$,frames:H}}function o(l,f,I,v,A,w,y){const C=Uint8Array,u=Uint32Array,i=new C(l[A-1]),L=new u(l[A-1]),N=A+1<l.length?new C(l[A+1]):null,M=new C(l[A]),B=new u(M.buffer);let D=f,z=I,F=-1,S=-1;for(let j=0;j<w.height;j++)for(let $=0;$<w.width;$++){const V=w.x+$,Q=w.y+j,Z=Q*f+V,ee=B[Z];ee==0||v[A-1].dispose==0&&L[Z]==ee&&(N==null||N[4*Z+3]!=0)||(V<D&&(D=V),V>F&&(F=V),Q<z&&(z=Q),Q>S&&(S=Q))}F==-1&&(D=z=F=S=0),y&&((1&D)==1&&D--,(1&z)==1&&z--),w={x:D,y:z,width:F-D+1,height:S-z+1};const H=v[A];H.rect=w,H.blend=1,H.img=new Uint8Array(w.width*w.height*4),v[A-1].dispose==0?(R(i,f,I,H.img,w.width,w.height,-w.x,-w.y,0),n(M,f,I,H.img,w)):R(M,f,I,H.img,w.width,w.height,-w.x,-w.y,0)}function n(l,f,I,v,A){R(l,f,I,v,A.width,A.height,-A.x,-A.y,2)}function s(l,f,I,v,A,w,y){const C=[];let u,i=[0,1,2,3,4];w!=-1?i=[w]:(f*v>5e5||I==1)&&(i=[0]),y&&(u={level:0});const L=Jt;for(var N=0;N<i.length;N++){for(let D=0;D<f;D++)h(A,l,D,v,I,i[N]);C.push(L.deflate(A,u))}let M,B=1e9;for(N=0;N<C.length;N++)C[N].length<B&&(M=N,B=C[N].length);return C[M]}function h(l,f,I,v,A,w){const y=I*v;let C=y+I;if(l[C]=w,C++,w==0)if(v<500)for(var u=0;u<v;u++)l[C+u]=f[y+u];else l.set(new Uint8Array(f.buffer,y,v),C);else if(w==1){for(u=0;u<A;u++)l[C+u]=f[y+u];for(u=A;u<v;u++)l[C+u]=f[y+u]-f[y+u-A]+256&255}else if(I==0){for(u=0;u<A;u++)l[C+u]=f[y+u];if(w==2)for(u=A;u<v;u++)l[C+u]=f[y+u];if(w==3)for(u=A;u<v;u++)l[C+u]=f[y+u]-(f[y+u-A]>>1)+256&255;if(w==4)for(u=A;u<v;u++)l[C+u]=f[y+u]-G(f[y+u-A],0,0)+256&255}else{if(w==2)for(u=0;u<v;u++)l[C+u]=f[y+u]+256-f[y+u-v]&255;if(w==3){for(u=0;u<A;u++)l[C+u]=f[y+u]+256-(f[y+u-v]>>1)&255;for(u=A;u<v;u++)l[C+u]=f[y+u]+256-(f[y+u-v]+f[y+u-A]>>1)&255}if(w==4){for(u=0;u<A;u++)l[C+u]=f[y+u]+256-G(0,f[y+u-v],0)&255;for(u=A;u<v;u++)l[C+u]=f[y+u]+256-G(f[y+u-A],f[y+u-v],f[y+u-A-v])&255}}}function b(l,f){const I=new Uint8Array(l),v=I.slice(0),A=new Uint32Array(v.buffer),w=k(v,f),y=w[0],C=w[1],u=I.length,i=new Uint8Array(u>>2);let L;if(I.length<2e7)for(var N=0;N<u;N+=4)L=m(y,M=I[N]*(1/255),B=I[N+1]*(1/255),D=I[N+2]*(1/255),z=I[N+3]*(1/255)),i[N>>2]=L.ind,A[N>>2]=L.est.rgba;else for(N=0;N<u;N+=4){var M=I[N]*.00392156862745098,B=I[N+1]*(1/255),D=I[N+2]*(1/255),z=I[N+3]*(1/255);for(L=y;L.left;)L=P(L.est,M,B,D,z)<=0?L.left:L.right;i[N>>2]=L.ind,A[N>>2]=L.est.rgba}return{abuf:v.buffer,inds:i,plte:C}}function k(l,f,I){I==null&&(I=1e-4);const v=new Uint32Array(l.buffer),A={i0:0,i1:l.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=U(l,A.i0,A.i1),A.est=p(A.bst);const w=[A];for(;w.length<f;){let C=0,u=0;for(var y=0;y<w.length;y++)w[y].est.L>C&&(C=w[y].est.L,u=y);if(C<I)break;const i=w[u],L=x(l,v,i.i0,i.i1,i.est.e,i.est.eMq255);if(i.i0>=L||i.i1<=L){i.est.L=0;continue}const N={i0:i.i0,i1:L,bst:null,est:null,tdst:0,left:null,right:null};N.bst=U(l,N.i0,N.i1),N.est=p(N.bst);const M={i0:L,i1:i.i1,bst:null,est:null,tdst:0,left:null,right:null};for(M.bst={R:[],m:[],N:i.bst.N-N.bst.N},y=0;y<16;y++)M.bst.R[y]=i.bst.R[y]-N.bst.R[y];for(y=0;y<4;y++)M.bst.m[y]=i.bst.m[y]-N.bst.m[y];M.est=p(M.bst),i.left=N,i.right=M,w[u]=N,w.push(M)}for(w.sort((C,u)=>u.bst.N-C.bst.N),y=0;y<w.length;y++)w[y].ind=y;return[A,w]}function m(l,f,I,v,A){if(l.left==null)return l.tdst=function(N,M,B,D,z){const F=M-N[0],S=B-N[1],H=D-N[2],j=z-N[3];return F*F+S*S+H*H+j*j}(l.est.q,f,I,v,A),l;const w=P(l.est,f,I,v,A);let y=l.left,C=l.right;w>0&&(y=l.right,C=l.left);const u=m(y,f,I,v,A);if(u.tdst<=w*w)return u;const i=m(C,f,I,v,A);return i.tdst<u.tdst?i:u}function P(l,f,I,v,A){const{e:w}=l;return w[0]*f+w[1]*I+w[2]*v+w[3]*A-l.eMq}function x(l,f,I,v,A,w){for(v-=4;I<v;){for(;E(l,I,A)<=w;)I+=4;for(;E(l,v,A)>w;)v-=4;if(I>=v)break;const y=f[I>>2];f[I>>2]=f[v>>2],f[v>>2]=y,I+=4,v-=4}for(;E(l,I,A)>w;)I-=4;return I+4}function E(l,f,I){return l[f]*I[0]+l[f+1]*I[1]+l[f+2]*I[2]+l[f+3]*I[3]}function U(l,f,I){const v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],w=I-f>>2;for(let y=f;y<I;y+=4){const C=l[y]*.00392156862745098,u=l[y+1]*(1/255),i=l[y+2]*(1/255),L=l[y+3]*(1/255);A[0]+=C,A[1]+=u,A[2]+=i,A[3]+=L,v[0]+=C*C,v[1]+=C*u,v[2]+=C*i,v[3]+=C*L,v[5]+=u*u,v[6]+=u*i,v[7]+=u*L,v[10]+=i*i,v[11]+=i*L,v[15]+=L*L}return v[4]=v[1],v[8]=v[2],v[9]=v[6],v[12]=v[3],v[13]=v[7],v[14]=v[11],{R:v,m:A,N:w}}function p(l){const{R:f}=l,{m:I}=l,{N:v}=l,A=I[0],w=I[1],y=I[2],C=I[3],u=v==0?0:1/v,i=[f[0]-A*A*u,f[1]-A*w*u,f[2]-A*y*u,f[3]-A*C*u,f[4]-w*A*u,f[5]-w*w*u,f[6]-w*y*u,f[7]-w*C*u,f[8]-y*A*u,f[9]-y*w*u,f[10]-y*y*u,f[11]-y*C*u,f[12]-C*A*u,f[13]-C*w*u,f[14]-C*y*u,f[15]-C*C*u],L=i,N=T;let M=[Math.random(),Math.random(),Math.random(),Math.random()],B=0,D=0;if(v!=0)for(let F=0;F<16&&(M=N.multVec(L,M),D=Math.sqrt(N.dot(M,M)),M=N.sml(1/D,M),!(F!=0&&Math.abs(D-B)<1e-9));F++)B=D;const z=[A*u,w*u,y*u,C*u];return{Cov:i,q:z,e:M,L:B,eMq255:N.dot(N.sml(255,z),M),eMq:N.dot(M,z),rgba:(Math.round(255*z[3])<<24|Math.round(255*z[2])<<16|Math.round(255*z[1])<<8|Math.round(255*z[0])<<0)>>>0}}var T={multVec:(l,f)=>[l[0]*f[0]+l[1]*f[1]+l[2]*f[2]+l[3]*f[3],l[4]*f[0]+l[5]*f[1]+l[6]*f[2]+l[7]*f[3],l[8]*f[0]+l[9]*f[1]+l[10]*f[2]+l[11]*f[3],l[12]*f[0]+l[13]*f[1]+l[14]*f[2]+l[15]*f[3]],dot:(l,f)=>l[0]*f[0]+l[1]*f[1]+l[2]*f[2]+l[3]*f[3],sml:(l,f)=>[l*f[0],l*f[1],l*f[2],l*f[3]]};pe.encode=function(f,I,v,A,w,y,C){A==null&&(A=0),C==null&&(C=!1);const u=r(f,I,v,A,[!1,!1,!1,0,C,!1]);return _(u,-1),g(u,I,v,w,y)},pe.encodeLL=function(f,I,v,A,w,y,C,u){const i={ctype:0+(A==1?0:2)+(w==0?0:4),depth:y,frames:[]},L=(A+w)*y,N=L*I;for(let M=0;M<f.length;M++)i.frames.push({rect:{x:0,y:0,width:I,height:v},img:new Uint8Array(f[M]),blend:0,dispose:1,bpp:Math.ceil(L/8),bpl:Math.ceil(N/8)});return _(i,0,!0),g(i,I,v,C,u)},pe.encode.compress=r,pe.encode.dither=a,pe.quantize=b,pe.quantize.getKDtree=k,pe.quantize.getNearest=m})();const ot={toArrayBuffer(R,O){const G=R.width,d=R.height,e=G<<2,t=R.getContext("2d").getImageData(0,0,G,d),c=new Uint32Array(t.data.buffer),a=(32*G+31)/32<<2,g=a*d,_=122+g,r=new ArrayBuffer(_),o=new DataView(r),n=1<<20;let s,h,b,k,m=n,P=0,x=0,E=0;function U(l){o.setUint16(x,l,!0),x+=2}function p(l){o.setUint32(x,l,!0),x+=4}function T(l){x+=l}U(19778),p(_),T(4),p(122),p(108),p(G),p(-d>>>0),U(1),U(32),p(3),p(g),p(2835),p(2835),T(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),function l(){for(;P<d&&m>0;){for(k=122+P*a,s=0;s<e;)m--,h=c[E++],b=h>>>24,o.setUint32(k+s,h<<8|b),s+=4;P++}E<c.length?(m=n,setTimeout(l,ot._dly)):O(r)}()},toBlob(R,O){this.toArrayBuffer(R,G=>{O(new Blob([G],{type:"image/bmp"}))})},_dly:9};var le={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},en={[le.CHROME]:16384,[le.FIREFOX]:11180,[le.DESKTOP_SAFARI]:16384,[le.IE]:8192,[le.IOS]:4096,[le.ETC]:8192};const qe=typeof window<"u",it=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,ze=qe&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),tn=(qe||it)&&(ze&&ze.getOriginalSymbol(window,"File")||typeof File<"u"&&File),at=(qe||it)&&(ze&&ze.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Xe(R,O,G=Date.now()){return new Promise(d=>{const e=R.split(","),t=e[0].match(/:(.*?);/)[1],c=globalThis.atob(e[1]);let a=c.length;const g=new Uint8Array(a);for(;a--;)g[a]=c.charCodeAt(a);const _=new Blob([g],{type:t});_.name=O,_.lastModified=G,d(_)})}function st(R){return new Promise((O,G)=>{const d=new at;d.onload=()=>O(d.result),d.onerror=e=>G(e),d.readAsDataURL(R)})}function lt(R){return new Promise((O,G)=>{const d=new Image;d.onload=()=>O(d),d.onerror=e=>G(e),d.src=R})}function xe(){if(xe.cachedResult!==void 0)return xe.cachedResult;let R=le.ETC;const{userAgent:O}=navigator;return/Chrom(e|ium)/i.test(O)?R=le.CHROME:/iP(ad|od|hone)/i.test(O)&&/WebKit/i.test(O)?R=le.IOS:/Safari/i.test(O)?R=le.DESKTOP_SAFARI:/Firefox/i.test(O)?R=le.FIREFOX:(/MSIE/i.test(O)||document.documentMode)&&(R=le.IE),xe.cachedResult=R,xe.cachedResult}function ft(R,O){const G=xe(),d=en[G];let e=R,t=O,c=e*t;const a=e>t?t/e:e/t;for(;c>d*d;){const g=(d+e)/2,_=(d+t)/2;g<_?(t=_,e=_*a):(t=g*a,e=g),c=e*t}return{width:e,height:t}}function Ve(R,O){let G,d;try{if(G=new OffscreenCanvas(R,O),d=G.getContext("2d"),d===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{G=document.createElement("canvas"),d=G.getContext("2d")}return G.width=R,G.height=O,[G,d]}function ct(R,O){const{width:G,height:d}=ft(R.width,R.height),[e,t]=Ve(G,d);return O&&/jpe?g/.test(O)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(R,0,0,e.width,e.height),e}function Fe(){return Fe.cachedResult!==void 0||(Fe.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Fe.cachedResult}function Be(R,O={}){return new Promise(function(G,d){let e,t;var c=function(){try{return t=ct(e,O.fileType||R.type),G([e,t])}catch(g){return d(g)}},a=function(g){try{var _=function(r){try{throw r}catch(o){return d(o)}};try{let r;return st(R).then(function(o){try{return r=o,lt(r).then(function(n){try{return e=n,function(){try{return c()}catch(s){return d(s)}}()}catch(s){return _(s)}},_)}catch(n){return _(n)}},_)}catch(r){_(r)}}catch(r){return d(r)}};try{if(Fe()||[le.DESKTOP_SAFARI,le.MOBILE_SAFARI].includes(xe()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(R).then(function(g){try{return e=g,c()}catch{return a()}},a)}catch{a()}})}function He(R,O,G,d,e=1){return new Promise(function(t,c){let a;if(O==="image/png"){let _,r,o;return _=R.getContext("2d"),{data:r}=_.getImageData(0,0,R.width,R.height),o=pe.encode([r.buffer],R.width,R.height,4096*e),a=new Blob([o],{type:O}),a.name=G,a.lastModified=d,g.call(this)}{let _=function(){return g.call(this)};if(O==="image/bmp")return new Promise(r=>ot.toBlob(R,r)).then((function(r){try{return a=r,a.name=G,a.lastModified=d,_.call(this)}catch(o){return c(o)}}).bind(this),c);{let r=function(){return _.call(this)};if(typeof OffscreenCanvas=="function"&&R instanceof OffscreenCanvas)return R.convertToBlob({type:O,quality:e}).then((function(o){try{return a=o,a.name=G,a.lastModified=d,r.call(this)}catch(n){return c(n)}}).bind(this),c);{let o;return o=R.toDataURL(O,e),Xe(o,G,d).then((function(n){try{return a=n,r.call(this)}catch(s){return c(s)}}).bind(this),c)}}}function g(){return t(a)}})}function ge(R){R.width=0,R.height=0}function Le(){return new Promise(function(R,O){let G,d,e,t;return Le.cachedResult!==void 0?R(Le.cachedResult):Xe("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(c){try{return G=c,Be(G).then(function(a){try{return d=a[1],He(d,G.type,G.name,G.lastModified).then(function(g){try{return e=g,ge(d),Be(e).then(function(_){try{return t=_[0],Le.cachedResult=t.width===1&&t.height===2,R(Le.cachedResult)}catch(r){return O(r)}},O)}catch(_){return O(_)}},O)}catch(g){return O(g)}},O)}catch(a){return O(a)}},O)})}function ut(R){return new Promise((O,G)=>{const d=new at;d.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return O(-2);const c=t.byteLength;let a=2;for(;a<c;){if(t.getUint16(a+2,!1)<=8)return O(-1);const g=t.getUint16(a,!1);if(a+=2,g==65505){if(t.getUint32(a+=2,!1)!=1165519206)return O(-1);const _=t.getUint16(a+=6,!1)==18761;a+=t.getUint32(a+4,_);const r=t.getUint16(a,_);a+=2;for(let o=0;o<r;o++)if(t.getUint16(a+12*o,_)==274)return O(t.getUint16(a+12*o+8,_))}else{if((65280&g)!=65280)break;a+=t.getUint16(a,!1)}}return O(-1)},d.onerror=e=>G(e),d.readAsArrayBuffer(R)})}function dt(R,O){const{width:G}=R,{height:d}=R,{maxWidthOrHeight:e}=O;let t,c=R;return isFinite(e)&&(G>e||d>e)&&([c,t]=Ve(G,d),G>d?(c.width=e,c.height=d/G*e):(c.width=G/d*e,c.height=e),t.drawImage(R,0,0,c.width,c.height),ge(R)),c}function pt(R,O){const{width:G}=R,{height:d}=R,[e,t]=Ve(G,d);switch(O>4&&O<9?(e.width=d,e.height=G):(e.width=G,e.height=d),O){case 2:t.transform(-1,0,0,1,G,0);break;case 3:t.transform(-1,0,0,-1,G,d);break;case 4:t.transform(1,0,0,-1,0,d);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,d,0);break;case 7:t.transform(0,-1,-1,0,d,G);break;case 8:t.transform(0,-1,1,0,0,G)}return t.drawImage(R,0,0,G,d),ge(R),e}function nt(R,O,G=0){return new Promise(function(d,e){let t,c,a,g,_,r,o,n,s,h,b,k,m,P,x,E,U,p,T,l;function f(v=5){if(O.signal&&O.signal.aborted)throw O.signal.reason;t+=v,O.onProgress(Math.min(t,100))}function I(v){if(O.signal&&O.signal.aborted)throw O.signal.reason;t=Math.min(Math.max(v,t),100),O.onProgress(t)}return t=G,c=O.maxIteration||10,a=1024*O.maxSizeMB*1024,f(),Be(R,O).then((function(v){try{return[,g]=v,f(),_=dt(g,O),f(),new Promise(function(A,w){var y;if(!(y=O.exifOrientation))return ut(R).then((function(u){try{return y=u,C.call(this)}catch(i){return w(i)}}).bind(this),w);function C(){return A(y)}return C.call(this)}).then((function(A){try{return r=A,f(),Le().then((function(w){try{return o=w?_:pt(_,r),f(),n=O.initialQuality||1,s=O.fileType||R.type,He(o,s,R.name,R.lastModified,n).then((function(y){try{{let u=function(){if(c--&&(x>a||x>m)){let L,N;return L=l?.95*T.width:T.width,N=l?.95*T.height:T.height,[U,p]=Ve(L,N),p.drawImage(T,0,0,L,N),n*=s==="image/png"?.85:.95,He(U,s,R.name,R.lastModified,n).then(function(M){try{return E=M,ge(T),T=U,x=E.size,I(Math.min(99,Math.floor((P-x)/(P-a)*100))),u}catch(B){return e(B)}},e)}return[1]},i=function(){return ge(T),ge(U),ge(_),ge(o),ge(g),I(100),d(E)};if(h=y,f(),b=h.size>a,k=h.size>R.size,!b&&!k)return I(100),d(h);var C;return m=R.size,P=h.size,x=P,T=o,l=!O.alwaysKeepResolution&&b,(C=(function(L){for(;L;){if(L.then)return void L.then(C,e);try{if(L.pop){if(L.length)return L.pop()?i.call(this):L;L=u}else L=L.call(this)}catch(N){return e(N)}}}).bind(this))(u)}}catch(u){return e(u)}}).bind(this),e)}catch(y){return e(y)}}).bind(this),e)}catch(w){return e(w)}}).bind(this),e)}catch(A){return e(A)}}).bind(this),e)})}const nn=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let je;function rn(R,O){return new Promise((G,d)=>{je||(je=function(c){const a=[];return a.push(c),URL.createObjectURL(new Blob(a))}(nn));const e=new Worker(je);e.addEventListener("message",function(c){if(O.signal&&O.signal.aborted)e.terminate();else if(c.data.progress===void 0){if(c.data.error)return d(new Error(c.data.error)),void e.terminate();G(c.data.file),e.terminate()}else O.onProgress(c.data.progress)}),e.addEventListener("error",d),O.signal&&O.signal.addEventListener("abort",()=>{d(O.signal.reason),e.terminate()}),e.postMessage({file:R,imageCompressionLibUrl:O.libURL,options:{...O,onProgress:void 0,signal:void 0}})})}function oe(R,O){return new Promise(function(G,d){let e,t,c,a,g,_;if(e={...O},c=0,{onProgress:a}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,g=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=s=>{c=s,typeof a=="function"&&a(c)},!(R instanceof Blob||R instanceof tn))return d(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(R.type))return d(new Error("The file given is not an image"));if(_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!g||typeof Worker!="function"||_)return nt(R,e).then((function(s){try{return t=s,n.call(this)}catch(h){return d(h)}}).bind(this),d);var r=(function(){try{return n.call(this)}catch(s){return d(s)}}).bind(this),o=function(s){try{return nt(R,e).then(function(h){try{return t=h,r()}catch(b){return d(b)}},d)}catch(h){return d(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",rn(R,e).then(function(s){try{return t=s,r()}catch{return o()}},o)}catch{o()}function n(){try{t.name=R.name,t.lastModified=R.lastModified}catch{}try{e.preserveExif&&R.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===R.type)&&(t=rt(R,t))}catch{}return G(t)}})}oe.getDataUrlFromFile=st,oe.getFilefromDataUrl=Xe,oe.loadImage=lt,oe.drawImageInCanvas=ct,oe.drawFileInCanvas=Be,oe.canvasToFile=He,oe.getExifOrientation=ut,oe.handleMaxWidthOrHeight=dt,oe.followExifOrientation=pt,oe.cleanupCanvasMemory=ge,oe.isAutoOrientationInBrowser=Le,oe.approximateBelowMaximumCanvasSizeOfBrowser=ft,oe.copyExifWithoutOrientation=rt,oe.getBrowserName=xe,oe.version="2.0.2";const un=gt({__name:"confirm",setup(R){const{lookStyle:O,base64:G,imageFile:d,promptA:e,promptB:t,promptC:c,promptD:a,customWorkflow:g,retryCount:_}=Je(),r=kt(),o=Tt(),n=yt(!1),s=It(()=>We().public.COMFYUI_GENERATE_ENABLED),h=()=>{Ke().alert({title:"ComfyUI Queue Disabled",message:"この環境では画像生成が許可されていません。",icon:"prohibited"})},b=async()=>{n.value=!0;try{if(!O)throw new Error("背景美術スタイルが選択されていません");let m;if(We().public.USE_API_FOR_GENERATION){const P=await At().optimize(G,512e3),{original_image_id:x}=await r.upload.originalImage(P),{workflow:E}=await r.template.workflow({backgroundArtStyleId:O.id,prompt:[e,t,c,a].join(" "),retry_count:_,original_image_id:x});m=E}else{const x=await(async U=>{const p={maxSizeMB:.8,maxWidthOrHeight:1216};try{const T=await oe(U,p);return console.log("圧縮されたファイル:",T),T}catch(T){console.error("画像の圧縮に失敗しました:",T)}})(d),{name:E}=await o.upload.image(x);m=We().public.ENVIRONMENT==="local"?qt:zt,m&&typeof m=="object"&&"nodes"in m&&m.nodes.forEach(p=>{p.type==="CLIPTextEncode"&&Array.isArray(p.widgets_values)&&p.widgets_values.length>0&&(e.length>0&&(p.widgets_values[0]=`${String(p.widgets_values[0])},What to draw,${e.join(",")}`),t.length>0&&(p.widgets_values[0]=`${String(p.widgets_values[0])},Environment around,${t.join(",")}`),c.length>0&&(p.widgets_values[0]=`${String(p.widgets_values[0])},Color tone and mood,${c.join(",")}`),a.length>0&&(p.widgets_values[0]=`${String(p.widgets_values[0])},Lighting,${a.join(",")}`))}),typeof m=="object"&&m!==null&&"nodes"in m&&m.nodes.forEach(p=>{const T=p;T.type==="LoadImage"&&(T.widgets_values=T.widgets_values.map(l=>typeof l=="string"?E:l))})}Je().setWorkflow(m),_t().push(tt().OUTPUT)}catch(m){n.value=!1,m instanceof vt?Ke().error(m):Ke().error({title:"Generate Error",message:"生成に失敗しました。",icon:"exclamation",button:"閉じる",code:bt.UnknownError,name:"UnknownError"})}},k=()=>{wt(tt().GENERATE_UPLOAD)};return(m,P)=>{const x=Nt,E=Et,U=Ct;return Te(),Se(E,{class:"pageGenerateConfirm",gap:"28"},{default:ve(()=>[be(x,null,{default:ve(()=>[be(St,{icon:"document",title:"設定内容の確認",body:"設定内容をご確認ください"})]),_:1}),be(x,null,{default:ve(()=>[be(E,{justify:"stretch",gap:"32"},{default:ve(()=>[be(E,{justify:"stretch",gap:"8"},{default:ve(()=>[se(O)?(Te(),Se(xt,{key:0,class:"pageGenerateConfirm-lookstyle",data:se(O)},null,8,["data"])):Re("",!0),se(G)?(Te(),Se(Ot,{key:1,data:se(G)},null,8,["data"])):Re("",!0),se(e)?(Te(),Se(Ge,{key:2,data:se(e),name:"何を描くか"},null,8,["data"])):Re("",!0),se(t)?(Te(),Se(Ge,{key:3,data:se(t),name:"周りの環境"},null,8,["data"])):Re("",!0),se(c)?(Te(),Se(Ge,{key:4,data:se(c),name:"色調・ムード"},null,8,["data"])):Re("",!0),se(a)?(Te(),Se(Ge,{key:5,data:se(a),name:"ライティング"},null,8,["data"])):Re("",!0)]),_:1}),be(E,{justify:"stretch",gap:"8"},{default:ve(()=>[be(U,{loading:se(n),disabled:!se(s),onClick:b,onDisabledClick:h},{default:ve(()=>P[0]||(P[0]=[et(" 生成する ")])),_:1},8,["loading","disabled"]),be(U,{minimal:"",disabled:se(n),onClick:k},{default:ve(()=>P[1]||(P[1]=[et(" 設定を変更する ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{un as default};
