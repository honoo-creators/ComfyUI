import{a4 as B,ad as _,o as i,a6 as n,a7 as x,a8 as T,aj as g,k as j,at as S,av as A,l as o,p as D,ai as E,aE as G,a5 as l,w as O,an as P,ao as V,al as z,g as F,f as U,as as I,a9 as J,aS as w,s as R,ab as M,ag as W,ah as X,y as q,z as H,aX as K,B as Q,aI as Y,a$ as Z,j as ee,aW as $,ac as L,c as N,ba as ae}from"./rv6QT8of.js";import{_ as te}from"./BE0E0OzR.js";import{_ as oe}from"./DclfOBor.js";const se={};function ne(d,r){const m=te;return i(),_(m,{per:240/530*100,class:"lookStyleRatio"},{default:n(()=>[x(d.$slots,"default")]),_:3})}const re=B(se,[["render",ne]]),ce={class:"lookStyle-image"},le={class:"lookStyle-name"},v=T({__name:"LookStyle",props:{data:{type:Object,default:()=>({})},current:{type:Boolean,default:!1}},setup(d){const r=d,m=g(()=>r.data.name),u=g(()=>r.data.id),p=g(()=>r.data.thumbnail_path);return(k,C)=>{const h=D,e=O;return i(),j("div",{class:z(["lookStyle",{_current:d.current}])},[S("div",ce,[o(p)?(i(),_(h,E({key:0},{src:o(p)},{cover:""}),null,16)):o(u)?(i(),_(oe,G(E({key:1},{id:o(u)})),null,16)):A("",!0)]),S("div",le,[l(re,null,{default:n(()=>[l(e,{"font-size":"28",extrabold:"",center:"",unselectable:"",color:"light"},{default:n(()=>[P(V(o(m)),1)]),_:1})]),_:1})])],2)}}}),de=T({__name:"lookstyle",setup(d){const r={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},m=ae(),u=F(),{lookStyle:p}=U(u),k=I([]),C=e=>{const c=k.value.find(t=>t.id===e);c&&(u.setLookStyle(c),L().replace(N().GENERATE_UPLOAD))},h=async()=>{const e=await m.select(["json"]);if(!e)return;const c=e.blob,t=async s=>new Promise((f,y)=>{const a=new FileReader;a.onload=()=>f(a.result),a.onerror=()=>y(new Error("ファイルの読み込みに失敗しました")),a.readAsText(s)});try{const f=await(await fetch(c)).blob(),y=await t(f),a={...r,name:e.name.replace(".json","")};u.setLookStyle(a),u.setCustomWorkflow(JSON.parse(y)),L().push(N().GENERATE_UPLOAD)}catch(s){console.error("JSONの変換に失敗しました:",s)}};return J(async()=>{var e,c;if(!w().active)return R("利用プランが選択されていません。");try{const t=await M().template.lookStyle(((e=w().active)==null?void 0:e.id)??0);(c=t.list)!=null&&c.length&&(k.value=t.list.map(s=>({...s,thumbnail_path:""})))}catch(t){if(t instanceof W)X().error(t);else return R("ルックスタイルの取得に失敗しました。")}}),(e,c)=>{const t=H,s=ee,f=Q,y=q;return i(),_(y,{class:"pageGenerateLookstyle",gap:"28"},{default:n(()=>[l(t,null,{default:n(()=>[l(K,{icon:"colorSwatch",title:"ルックスタイルを選択してください",body:"プロジェクト専用のスタイルを選び、<br />作品の世界観を引き立てましょう。"})]),_:1}),l(t,{wide:""},{default:n(()=>[l(f,{justify:"center",gap:"8",split:"2"},{default:n(()=>[(i(!0),j(Y,null,Z(o(k),a=>(i(),_(s,{key:a.id,class:"pageGenerateLookstyle-item",onClick:b=>C(a.id)},{default:n(()=>{var b;return[l(v,{data:a,current:a.id===((b=o(p))==null?void 0:b.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in e?e.useRuntimeConfig:o($))().public.DEV_ENABLED&&("useRuntimeConfig"in e?e.useRuntimeConfig:o($))().public.ENVIRONMENT==="local"?(i(),_(s,{key:0,class:"pageGenerateLookstyle-item",onClick:h},{default:n(()=>{var a;return[l(v,{data:r,current:r.id===((a=o(p))==null?void 0:a.id)},null,8,["current"])]}),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})}}});export{de as default};
