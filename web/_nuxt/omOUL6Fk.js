import{aa as R,p as N,m as A,af as G,ab as T,as as y,s as C,ad as j,ay as O,ax as $,o as m,ai as _,w as n,a as r,aq as v,c as B,aP as D,u as i,aO as F,az as b,aj as P,ae as h,l as g,G as U,t as V,I as x,F as I,b5 as J}from"./TvOMxzgX.js";import{L as E}from"./BoDtCuA5.js";import"./7oZ-js4J.js";import"./DzQ-Df-v.js";const K=R({__name:"lookstyle",setup(M){const p={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},w=J(),u=N(),{lookStyle:k}=A(u),d=G([]),L=t=>{const s=d.value.find(a=>a.id===t);s&&(u.setLookStyle(s),h().replace(g().GENERATE_UPLOAD))},S=async()=>{const t=await w.select(["json"]),s=t.blob,a=async o=>new Promise((l,c)=>{const e=new FileReader;e.onload=()=>l(e.result),e.onerror=()=>c(new Error("ファイルの読み込みに失敗しました")),e.readAsText(o)});try{const l=await(await fetch(s)).blob(),c=await a(l),e={...p,name:t.name.replace(".json","")};u.setLookStyle(e),u.setCustomWorkflow(JSON.parse(c)),h().push(g().GENERATE_UPLOAD)}catch(o){console.error("JSONの変換に失敗しました:",o)}};return T(async()=>{var t,s;if(!y().active)return C("利用プランが選択されていません。");try{const a=await j().template.lookStyle(((t=y().active)==null?void 0:t.id)??0);(s=a.list)!=null&&s.length&&(d.value=a.list.map(o=>({...o,thumbnail_path:""})))}catch(a){if(a instanceof O)$().error(a);else return C("ルックスタイルの取得に失敗しました。")}}),(t,s)=>{const a=U,o=V,l=x,c=I;return m(),_(c,{class:"pageGenerateLookstyle",gap:"28"},{default:n(()=>[r(a,null,{default:n(()=>[r(v,{icon:"colorSwatch",title:"ルックスタイルを選択してください",body:"プロジェクト専用のスタイルを選び、<br />作品の世界観を引き立てましょう。"})]),_:1}),r(a,{wide:""},{default:n(()=>[r(l,{justify:"center",gap:"8",split:"2"},{default:n(()=>[(m(!0),B(F,null,D(i(d),e=>(m(),_(o,{key:e.id,class:"pageGenerateLookstyle-item",onClick:f=>L(e.id)},{default:n(()=>{var f;return[r(E,{data:e,current:e.id===((f=i(k))==null?void 0:f.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in t?t.useRuntimeConfig:i(b))().public.DEV_ENABLED&&("useRuntimeConfig"in t?t.useRuntimeConfig:i(b))().public.ENVIRONMENT==="local"?(m(),_(o,{key:0,class:"pageGenerateLookstyle-item",onClick:S},{default:n(()=>{var e;return[r(E,{data:p,current:p.id===((e=i(k))==null?void 0:e.id)},null,8,["current"])]}),_:1})):P("",!0)]),_:1})]),_:1})]),_:1})}}});export{K as default};
