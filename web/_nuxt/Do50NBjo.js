import{d as S,aE as R,am as A,x as $,o as G,aa as k,s as y,a as N,ag as j,af as v,f as u,i as d,w as r,z as l,g as F,G as T,Y as m,F as x,$ as B,aF as h,l as D,e as g,c as C,V as U,t as O,U as P,a1 as V}from"./DTE7kaSZ.js";import{_ as J}from"./C-5YsgHm.js";import{_ as b}from"./Co1BzhBC.js";import"./A_v5ED_Z.js";import"./RPAqyMEW.js";import"./BcirAi-M.js";const K=S({__name:"lookstyle",setup(z){const p={id:-1,name:"Custom Load",thumbnail_path:"https://cdn.pixabay.com/photo/2023/02/27/15/15/abstract-7818693_1280.jpg"},E=V(),i=R(),{lookStyle:f}=A(i),_=$([]),w=o=>{const a=_.value.find(e=>e.id===o);a&&(i.setLookStyle(a),g().push(C().GENERATE_UPLOAD))},L=async()=>{const o=await E.select(["json"]),a=o.blob,e=async n=>new Promise((c,t)=>{const s=new FileReader;s.onload=()=>c(s.result),s.onerror=()=>t(new Error("ファイルの読み込みに失敗しました")),s.readAsText(n)});try{const c=await(await fetch(a)).blob(),t=await e(c),s={...p,name:o.name.replace(".json","")};i.setLookStyle(s),i.setCustomWorkflow(JSON.parse(t)),g().push(C().GENERATE_UPLOAD)}catch(n){console.error("JSONの変換に失敗しました:",n)}};return G(async()=>{var o,a;if(!k().active)return y("利用プランが選択されていません。");try{const e=await N().template.lookStyle(((o=k().active)==null?void 0:o.id)??0);(a=e.list)!=null&&a.length&&(_.value=e.list.map(n=>({...n,thumbnail_path:"/honoo/assets/lookstyle/honoo_bgart_v04.jpg"})))}catch(e){if(e instanceof j)v().error(e);else return y("背景美術スタイルの取得に失敗しました。")}}),(o,a)=>{const e=U,n=O,c=P;return u(),d(c,{class:"pageGenerateLookstyle",gap:"28"},{default:r(()=>[l(e,null,{default:r(()=>[l(J,{icon:"shapes",title:"背景美術スタイルを選択してください",body:"事前に設定されたルックスタイルがある場合は<br />該当するスタイルを選んでください。"})]),_:1}),l(e,{wide:""},{default:r(()=>[l(n,{justify:"center",gap:"16"},{default:r(()=>[(u(!0),F(x,null,T(m(_),t=>(u(),d(h,{key:t.id,class:"pageGenerateLookstyle-item",onClick:s=>w(t.id)},{default:r(()=>{var s;return[l(b,{data:t,current:t.id===((s=m(f))==null?void 0:s.id)},null,8,["data","current"])]}),_:2},1032,["onClick"]))),128)),("useRuntimeConfig"in o?o.useRuntimeConfig:m(B))().public.DEV_ENABLED?(u(),d(h,{key:0,class:"pageGenerateLookstyle-item",onClick:L},{default:r(()=>{var t;return[l(b,{data:p,current:p.id===((t=m(f))==null?void 0:t.id)},null,8,["current"])]}),_:1})):D("",!0)]),_:1})]),_:1})]),_:1})}}});export{K as default};
